var hn=Object.create;var Xs=Object.defineProperty;var fn=Object.getOwnPropertyDescriptor;var mn=Object.getOwnPropertyNames;var gn=Object.getPrototypeOf,yn=Object.prototype.hasOwnProperty;var C=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var vn=(t,e,r,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of mn(e))!yn.call(t,i)&&i!==r&&Xs(t,i,{get:()=>e[i],enumerable:!(s=fn(e,i))||s.enumerable});return t};var ge=(t,e,r)=>(r=t!=null?hn(gn(t)):{},vn(e||!t||!t.__esModule?Xs(r,"default",{value:t,enumerable:!0}):r,t));var Nr=C((Yl,Ys)=>{Ys.exports=function(){var e={},r=e._fns={};e.emit=function(n,a,l,d,p,u,h){var c=s(n);c.length&&i(n,c,[a,l,d,p,u,h])},e.on=function(n,a){r[n]||(r[n]=[]),r[n].push(a)},e.once=function(n,a){function l(){a.apply(this,arguments),e.off(n,l)}this.on(n,l)},e.off=function(n,a){var l=[];if(n&&a){var d=this._fns[n],p=0,u=d?d.length:0;for(p;p<u;p++)d[p]!==a&&l.push(d[p])}l.length?this._fns[n]=l:delete this._fns[n]};function s(o){var n=r[o]?r[o]:[],a=o.indexOf(":"),l=a===-1?[o]:[o.substring(0,a),o.substring(a+1)],d=Object.keys(r),p=0,u=d.length;for(p;p<u;p++){var h=d[p];if(h==="*"&&(n=n.concat(r[h])),l.length===2&&l[0]===h){n=n.concat(r[h]);break}}return n}function i(o,n,a){var l=0,d=n.length;for(l;l<d&&n[l];l++)n[l].event=o,n[l].apply(n[l],a)}return e}});var or=C((Zl,Zs)=>{function Tn(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}Zs.exports=Tn});var ti=C((eu,ei)=>{var Fn=typeof global=="object"&&global&&global.Object===Object&&global;ei.exports=Fn});var Mr=C((tu,ri)=>{var En=ti(),Un=typeof self=="object"&&self&&self.Object===Object&&self,On=En||Un||Function("return this")();ri.exports=On});var ii=C((ru,si)=>{var xn=Mr(),An=function(){return xn.Date.now()};si.exports=An});var ni=C((su,oi)=>{var Cn=/\s/;function kn(t){for(var e=t.length;e--&&Cn.test(t.charAt(e)););return e}oi.exports=kn});var li=C((iu,ai)=>{var Rn=ni(),$n=/^\s+/;function jn(t){return t&&t.slice(0,Rn(t)+1).replace($n,"")}ai.exports=jn});var Br=C((ou,ui)=>{var Nn=Mr(),Mn=Nn.Symbol;ui.exports=Mn});var hi=C((nu,ci)=>{var di=Br(),pi=Object.prototype,Bn=pi.hasOwnProperty,Ln=pi.toString,yt=di?di.toStringTag:void 0;function In(t){var e=Bn.call(t,yt),r=t[yt];try{t[yt]=void 0;var s=!0}catch{}var i=Ln.call(t);return s&&(e?t[yt]=r:delete t[yt]),i}ci.exports=In});var mi=C((au,fi)=>{var Dn=Object.prototype,qn=Dn.toString;function zn(t){return qn.call(t)}fi.exports=zn});var _i=C((lu,vi)=>{var gi=Br(),Hn=hi(),Gn=mi(),Kn="[object Null]",Wn="[object Undefined]",yi=gi?gi.toStringTag:void 0;function Xn(t){return t==null?t===void 0?Wn:Kn:yi&&yi in Object(t)?Hn(t):Gn(t)}vi.exports=Xn});var wi=C((uu,bi)=>{function Jn(t){return t!=null&&typeof t=="object"}bi.exports=Jn});var Pi=C((du,Si)=>{var Vn=_i(),Yn=wi(),Qn="[object Symbol]";function Zn(t){return typeof t=="symbol"||Yn(t)&&Vn(t)==Qn}Si.exports=Zn});var Ui=C((pu,Ei)=>{var ea=li(),Ti=or(),ta=Pi(),Fi=NaN,ra=/^[-+]0x[0-9a-f]+$/i,sa=/^0b[01]+$/i,ia=/^0o[0-7]+$/i,oa=parseInt;function na(t){if(typeof t=="number")return t;if(ta(t))return Fi;if(Ti(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Ti(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=ea(t);var r=sa.test(t);return r||ia.test(t)?oa(t.slice(2),r?2:8):ra.test(t)?Fi:+t}Ei.exports=na});var Ai=C((cu,xi)=>{var aa=or(),Lr=ii(),Oi=Ui(),la="Expected a function",ua=Math.max,da=Math.min;function pa(t,e,r){var s,i,o,n,a,l,d=0,p=!1,u=!1,h=!0;if(typeof t!="function")throw new TypeError(la);e=Oi(e)||0,aa(r)&&(p=!!r.leading,u="maxWait"in r,o=u?ua(Oi(r.maxWait)||0,e):o,h="trailing"in r?!!r.trailing:h);function c(E){var P=s,U=i;return s=i=void 0,d=E,n=t.apply(U,P),n}function f(E){return d=E,a=setTimeout(v,e),p?c(E):n}function S(E){var P=E-l,U=E-d,O=e-P;return u?da(O,o-U):O}function _(E){var P=E-l,U=E-d;return l===void 0||P>=e||P<0||u&&U>=o}function v(){var E=Lr();if(_(E))return F(E);a=setTimeout(v,S(E))}function F(E){return a=void 0,h&&s?c(E):(s=i=void 0,n)}function x(){a!==void 0&&clearTimeout(a),d=0,s=l=i=a=void 0}function A(){return a===void 0?n:F(Lr())}function R(){var E=Lr(),P=_(E);if(s=arguments,i=this,l=E,P){if(a===void 0)return f(l);if(u)return clearTimeout(a),a=setTimeout(v,e),c(l)}return a===void 0&&(a=setTimeout(v,e)),n}return R.cancel=x,R.flush=A,R}xi.exports=pa});var Ir=C((hu,Ci)=>{var ca=Ai(),ha=or(),fa="Expected a function";function ma(t,e,r){var s=!0,i=!0;if(typeof t!="function")throw new TypeError(fa);return ha(r)&&(s="leading"in r?!!r.leading:s,i="trailing"in r?!!r.trailing:i),ca(t,e,{leading:s,maxWait:e,trailing:i})}Ci.exports=ma});var Kr=C((Uu,Li)=>{"use strict";Li.exports=function(e){if(typeof e!="number"||Number.isNaN(e))throw new TypeError(`Expected a number, got ${typeof e}`);let r=e<0,s=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];if(r&&(e=-e),e<1)return`${(r?"-":"")+e} B`;let i=Math.min(Math.floor(Math.log(e)/Math.log(1024)),s.length-1);e=Number(e/1024**i);let o=s[i];return e>=10||e%1===0?`${(r?"-":"")+e.toFixed(0)} ${o}`:`${(r?"-":"")+e.toFixed(1)} ${o}`}});var qi=C((Ou,Di)=>{"use strict";function Ii(t,e){this.text=t=t||"",this.hasWild=~t.indexOf("*"),this.separator=e,this.parts=t.split(e)}Ii.prototype.match=function(t){var e=!0,r=this.parts,s,i=r.length,o;if(typeof t=="string"||t instanceof String)if(!this.hasWild&&this.text!=t)e=!1;else{for(o=(t||"").split(this.separator),s=0;e&&s<i;s++)r[s]!=="*"&&(s<o.length?e=r[s]===o[s]:e=!1);e=e&&o}else if(typeof t.splice=="function")for(e=[],s=t.length;s--;)this.match(t[s])&&(e[e.length]=t[s]);else if(typeof t=="object"){e={};for(var n in t)this.match(n)&&(e[n]=t[n])}return e};Di.exports=function(t,e,r){var s=new Ii(t,r||/[\/\.]/);return typeof e<"u"?s.match(e):s}});var Hi=C((xu,zi)=>{var wa=qi(),Sa=/[\/\+\.]/;zi.exports=function(t,e){function r(s){var i=wa(s,t,Sa);return i&&i.length>=2}return e?r(e.split(";")[0]):r}});var cs=C((Ud,Pr)=>{(function(){"use strict";var t={}.hasOwnProperty;function e(){for(var i="",o=0;o<arguments.length;o++){var n=arguments[o];n&&(i=s(i,r(n)))}return i}function r(i){if(typeof i=="string"||typeof i=="number")return i;if(typeof i!="object")return"";if(Array.isArray(i))return e.apply(null,i);if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]"))return i.toString();var o="";for(var n in i)t.call(i,n)&&i[n]&&(o=s(o,n));return o}function s(i,o){return o?i?i+" "+o:i+o:i}typeof Pr<"u"&&Pr.exports?(e.default=e,Pr.exports=e):typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("classnames",[],function(){return e}):window.classNames=e})()});var Ro=C((Qd,ko)=>{function de(t,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}ko.exports=de;de.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};de.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};de.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=new Date().getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var s=this;return this._timer=setTimeout(function(){s._attempts++,s._operationTimeoutCb&&(s._timeout=setTimeout(function(){s._operationTimeoutCb(s._attempts)},s._operationTimeout),s._options.unref&&s._timeout.unref()),s._fn(s._attempts)},r),this._options.unref&&this._timer.unref(),!0};de.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};de.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)};de.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)};de.prototype.start=de.prototype.try;de.prototype.errors=function(){return this._errors};de.prototype.attempts=function(){return this._attempts};de.prototype.mainError=function(){if(this._errors.length===0)return null;for(var t={},e=null,r=0,s=0;s<this._errors.length;s++){var i=this._errors[s],o=i.message,n=(t[o]||0)+1;t[o]=n,n>=r&&(e=i,r=n)}return e}});var $o=C(He=>{var al=Ro();He.operation=function(t){var e=He.timeouts(t);return new al(e,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})};He.timeouts=function(t){if(t instanceof Array)return[].concat(t);var e={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var r in t)e[r]=t[r];if(e.minTimeout>e.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var s=[],i=0;i<e.retries;i++)s.push(this.createTimeout(i,e));return t&&t.forever&&!s.length&&s.push(this.createTimeout(i,e)),s.sort(function(o,n){return o-n}),s};He.createTimeout=function(t,e){var r=e.randomize?Math.random()+1:1,s=Math.round(r*Math.max(e.minTimeout,1)*Math.pow(e.factor,t));return s=Math.min(s,e.maxTimeout),s};He.wrap=function(t,e,r){if(e instanceof Array&&(r=e,e=null),!r){r=[];for(var s in t)typeof t[s]=="function"&&r.push(s)}for(var i=0;i<r.length;i++){var o=r[i],n=t[o];t[o]=function(l){var d=He.operation(e),p=Array.prototype.slice.call(arguments,1),u=p.pop();p.push(function(h){d.retry(h)||(h&&(arguments[0]=d.mainError()),u.apply(this,arguments))}),d.attempt(function(){l.apply(t,p)})}.bind(t,n),t[o].options=e}}});var No=C((ep,jo)=>{jo.exports=$o()});function ir(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var _n=0;function Vs(t){return"__private_"+_n+++"_"+t}function bn(t,e,r){let s=[];return t.forEach(i=>typeof i!="string"?s.push(i):e[Symbol.split](i).forEach((o,n,a)=>{o!==""&&s.push(o),n<a.length-1&&s.push(r)})),s}function Js(t,e){let r=/\$/g,s="$$$$",i=[t];if(e==null)return i;for(let o of Object.keys(e))if(o!=="_"){let n=e[o];typeof n=="string"&&(n=r[Symbol.replace](n,s)),i=bn(i,new RegExp(`%\\{${o}\\}`,"g"),n)}return i}var wn=t=>{throw new Error(`missing string: ${t}`)},mt=Vs("onMissingKey"),gt=Vs("apply"),Ne=class{constructor(e,r){let{onMissingKey:s=wn}=r===void 0?{}:r;Object.defineProperty(this,gt,{value:Sn}),Object.defineProperty(this,mt,{writable:!0,value:void 0}),this.locale={strings:{},pluralize(i){return i===1?0:1}},Array.isArray(e)?e.forEach(ir(this,gt)[gt],this):ir(this,gt)[gt](e),ir(this,mt)[mt]=s}translate(e,r){return this.translateArray(e,r).join("")}translateArray(e,r){let s=this.locale.strings[e];if(s==null&&(ir(this,mt)[mt](e),s=e),typeof s=="object"){if(r&&typeof r.smart_count<"u"){let o=this.locale.pluralize(r.smart_count);return Js(s[o],r)}throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")}if(typeof s!="string")throw new Error("string was not a string");return Js(s,r)}};function Sn(t){if(!(t!=null&&t.strings))return;let e=this.locale;Object.assign(this.locale,{strings:{...e.strings,...t.strings},pluralize:t.pluralize||e.pluralize})}var Vi=ge(Nr(),1);var Pn="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";var Qs=(t=21)=>{let e="",r=t;for(;r--;)e+=Pn[Math.random()*64|0];return e};var Yi=ge(Ir(),1);function nr(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var ga=0;function ki(t){return"__private_"+ga+++"_"+t}var ya={version:"3.2.2"},Me=ki("callbacks"),Dr=ki("publish"),ar=class{constructor(){Object.defineProperty(this,Dr,{value:va}),this.state={},Object.defineProperty(this,Me,{writable:!0,value:new Set})}getState(){return this.state}setState(e){let r={...this.state},s={...this.state,...e};this.state=s,nr(this,Dr)[Dr](r,s,e)}subscribe(e){return nr(this,Me)[Me].add(e),()=>{nr(this,Me)[Me].delete(e)}}};function va(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];nr(this,Me)[Me].forEach(s=>{s(...e)})}ar.VERSION=ya.version;var Ri=ar;function vt(t){let e=t.lastIndexOf(".");return e===-1||e===t.length-1?{name:t,extension:void 0}:{name:t.slice(0,e),extension:t.slice(e+1)}}var qr={__proto__:null,md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",webp:"image/webp",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",dicom:"application/dicom",doc:"application/msword",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",tar:"application/x-tar",gz:"application/gzip",dmg:"application/x-apple-diskimage"};function _t(t){var e;if(t.type)return t.type;let r=t.name?(e=vt(t.name).extension)==null?void 0:e.toLowerCase():null;return r&&r in qr?qr[r]:"application/octet-stream"}function _a(t){return t.charCodeAt(0).toString(32)}function $i(t){let e="";return t.replace(/[^A-Z0-9]/gi,r=>(e+=`-${_a(r)}`,"/"))+e}function ji(t){let e="uppy";return typeof t.name=="string"&&(e+=`-${$i(t.name.toLowerCase())}`),t.type!==void 0&&(e+=`-${t.type}`),t.meta&&typeof t.meta.relativePath=="string"&&(e+=`-${$i(t.meta.relativePath.toLowerCase())}`),t.data.size!==void 0&&(e+=`-${t.data.size}`),t.data.lastModified!==void 0&&(e+=`-${t.data.lastModified}`),e}function ba(t){return!t.isRemote||!t.remote?!1:new Set(["box","dropbox","drive","facebook","unsplash"]).has(t.remote.provider)}function Ni(t){if(ba(t))return t.id;let e=_t(t);return ji({...t,type:e})}function zr(t){if(t==null&&typeof navigator<"u"&&(t=navigator.userAgent),!t)return!0;let e=/Edge\/(\d+\.\d+)/.exec(t);if(!e)return!0;let s=e[1].split(".",2),i=parseInt(s[0],10),o=parseInt(s[1],10);return i<15||i===15&&o<15063||i>18||i===18&&o>=18218}function Hr(t,e){return e.name?e.name:t.split("/")[0]==="image"?`${t.split("/")[0]}.${t.split("/")[1]}`:"noname"}function Gr(t){return t<10?`0${t}`:t.toString()}function dt(){let t=new Date,e=Gr(t.getHours()),r=Gr(t.getMinutes()),s=Gr(t.getSeconds());return`${e}:${r}:${s}`}var Mi={debug:()=>{},warn:()=>{},error:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return console.error(`[Uppy] [${dt()}]`,...e)}},Bi={debug:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return console.debug(`[Uppy] [${dt()}]`,...e)},warn:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return console.warn(`[Uppy] [${dt()}]`,...e)},error:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return console.error(`[Uppy] [${dt()}]`,...e)}};var lr=ge(Kr(),1),Gi=ge(Hi(),1),Ki={maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null,requiredMetaFields:[]},Z=class extends Error{constructor(e,r){var s;super(e),this.isRestriction=!0,this.isUserFacing=(s=r?.isUserFacing)!=null?s:!0,r!=null&&r.file&&(this.file=r.file)}},ur=class{constructor(e,r){this.i18n=r,this.getOpts=()=>{var s;let i=e();if(((s=i.restrictions)==null?void 0:s.allowedFileTypes)!=null&&!Array.isArray(i.restrictions.allowedFileTypes))throw new TypeError("`restrictions.allowedFileTypes` must be an array");return i}}validateAggregateRestrictions(e,r){let{maxTotalFileSize:s,maxNumberOfFiles:i}=this.getOpts().restrictions;if(i&&e.filter(n=>!n.isGhost).length+r.length>i)throw new Z(`${this.i18n("youCanOnlyUploadX",{smart_count:i})}`);if(s){let o=e.reduce((n,a)=>{var l;return n+((l=a.size)!=null?l:0)},0);for(let n of r)if(n.size!=null&&(o+=n.size,o>s))throw new Z(this.i18n("exceedsSize",{size:(0,lr.default)(s),file:n.name}))}}validateSingleFile(e){let{maxFileSize:r,minFileSize:s,allowedFileTypes:i}=this.getOpts().restrictions;if(i&&!i.some(n=>n.includes("/")?e.type?(0,Gi.default)(e.type.replace(/;.*?$/,""),n):!1:n[0]==="."&&e.extension?e.extension.toLowerCase()===n.slice(1).toLowerCase():!1)){let n=i.join(", ");throw new Z(this.i18n("youCanOnlyUploadFileTypes",{types:n}),{file:e})}if(r&&e.size!=null&&e.size>r)throw new Z(this.i18n("exceedsSize",{size:(0,lr.default)(r),file:e.name}),{file:e});if(s&&e.size!=null&&e.size<s)throw new Z(this.i18n("inferiorSize",{size:(0,lr.default)(s)}),{file:e})}validate(e,r){r.forEach(s=>{this.validateSingleFile(s)}),this.validateAggregateRestrictions(e,r)}validateMinNumberOfFiles(e){let{minNumberOfFiles:r}=this.getOpts().restrictions;if(r&&Object.keys(e).length<r)throw new Z(this.i18n("youHaveToAtLeastSelectX",{smart_count:r}))}getMissingRequiredMetaFields(e){let r=new Z(this.i18n("missingRequiredMetaFieldOnFile",{fileName:e.name})),{requiredMetaFields:s}=this.getOpts().restrictions,i=[];for(let o of s)(!Object.hasOwn(e.meta,o)||e.meta[o]==="")&&i.push(o);return{missingFields:i,error:r}}};var Wi={strings:{addBulkFilesFailed:{0:"Failed to add %{smart_count} file due to an internal error",1:"Failed to add %{smart_count} files due to internal errors"},youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},exceedsSize:"%{file} exceeds maximum allowed size of %{size}",missingRequiredMetaField:"Missing required meta fields",missingRequiredMetaFieldOnFile:"Missing required meta fields in %{fileName}",inferiorSize:"This file is smaller than the allowed size of %{size}",youCanOnlyUploadFileTypes:"You can only upload: %{types}",noMoreFilesAllowed:"Cannot add more files",noDuplicates:"Cannot add the duplicate file '%{fileName}', it already exists",companionError:"Connection with Companion failed",authAborted:"Authentication aborted",companionUnauthorizeHint:"To unauthorize to your %{provider} account, please go to %{url}",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",noSearchResults:"Unfortunately, there are no results for this search",selectX:{0:"Select %{smart_count}",1:"Select %{smart_count}"},allFilesFromFolderNamed:"All files from folder %{name}",openFolderNamed:"Open folder %{name}",cancel:"Cancel",logOut:"Log out",filter:"Filter",resetFilter:"Reset filter",loading:"Loading...",loadedXFiles:"Loaded %{numFiles} files",authenticateWithTitle:"Please authenticate with %{pluginName} to select files",authenticateWith:"Connect to %{pluginName}",signInWithGoogle:"Sign in with Google",searchImages:"Search for images",enterTextToSearch:"Enter text to search for images",search:"Search",resetSearch:"Reset search",emptyFolderAdded:"No files were added from empty folder",addedNumFiles:"Added %{numFiles} file(s)",folderAlreadyAdded:'The folder "%{folder}" was already added',folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"},additionalRestrictionsFailed:"%{count} additional restrictions were not fulfilled"}};var Xi,Ji;function g(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var Pa=0;function N(t){return"__private_"+Pa+++"_"+t}var Ta={version:"3.10.1"},dr={totalProgress:0,allowNewUpload:!0,error:null,recoveredState:null},q=N("plugins"),te=N("restricter"),bt=N("storeUnsubscribe"),ye=N("emitter"),Be=N("preProcessors"),Le=N("uploaders"),be=N("postProcessors"),re=N("informAndEmit"),Ft=N("checkRequiredMetaFieldsOnFile"),Wr=N("checkRequiredMetaFields"),wt=N("assertNewUploadAllowed"),Vr=N("transformFile"),St=N("startIfAutoProceed"),Pt=N("checkAndUpdateFileState"),Xr=N("addListeners"),ce=N("updateOnlineStatus"),Tt=N("requestClientById"),ve=N("createUpload"),Jr=N("getUpload"),Ie=N("removeUpload"),_e=N("runUpload");Xi=Symbol.for("uppy test: getPlugins");Ji=Symbol.for("uppy test: createUpload");var pr=class t{constructor(e){Object.defineProperty(this,_e,{value:Na}),Object.defineProperty(this,Ie,{value:ja}),Object.defineProperty(this,Jr,{value:$a}),Object.defineProperty(this,ve,{value:Ra}),Object.defineProperty(this,Xr,{value:ka}),Object.defineProperty(this,Pt,{value:Ca}),Object.defineProperty(this,St,{value:Aa}),Object.defineProperty(this,Vr,{value:xa}),Object.defineProperty(this,wt,{value:Oa}),Object.defineProperty(this,Wr,{value:Ua}),Object.defineProperty(this,Ft,{value:Ea}),Object.defineProperty(this,re,{value:Fa}),Object.defineProperty(this,q,{writable:!0,value:Object.create(null)}),Object.defineProperty(this,te,{writable:!0,value:void 0}),Object.defineProperty(this,bt,{writable:!0,value:void 0}),Object.defineProperty(this,ye,{writable:!0,value:(0,Vi.default)()}),Object.defineProperty(this,Be,{writable:!0,value:new Set}),Object.defineProperty(this,Le,{writable:!0,value:new Set}),Object.defineProperty(this,be,{writable:!0,value:new Set}),this.scheduledAutoProceed=null,this.wasOffline=!1,this.calculateProgress=(0,Yi.default)((i,o)=>{let n=this.getFile(i?.id);if(i==null||!n){this.log(`Not setting progress for a file that has been removed: ${i?.id}`);return}if(n.progress.percentage===100){this.log(`Not setting progress for a file that has been already uploaded: ${i.id}`);return}let a=Number.isFinite(o.bytesTotal)&&o.bytesTotal>0;this.setFileState(i.id,{progress:{...n.progress,bytesUploaded:o.bytesUploaded,bytesTotal:o.bytesTotal,percentage:a?Math.round(o.bytesUploaded/o.bytesTotal*100):0}}),this.calculateTotalProgress()},500,{leading:!0,trailing:!0}),Object.defineProperty(this,ce,{writable:!0,value:this.updateOnlineStatus.bind(this)}),Object.defineProperty(this,Tt,{writable:!0,value:new Map}),this.defaultLocale=Wi;let r={id:"uppy",autoProceed:!1,allowMultipleUploadBatches:!0,debug:!1,restrictions:Ki,meta:{},onBeforeFileAdded:(i,o)=>!Object.hasOwn(o,i.id),onBeforeUpload:i=>i,store:new Ri,logger:Mi,infoTimeout:5e3},s={...r,...e};this.opts={...s,restrictions:{...r.restrictions,...e&&e.restrictions}},e&&e.logger&&e.debug?this.log("You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.","warning"):e&&e.debug&&(this.opts.logger=Bi),this.log(`Using Core v${t.VERSION}`),this.i18nInit(),this.store=this.opts.store,this.setState({...dr,plugins:{},files:{},currentUploads:{},capabilities:{uploadProgress:zr(),individualCancellation:!0,resumableUploads:!1},meta:{...this.opts.meta},info:[]}),g(this,te)[te]=new ur(()=>this.opts,this.i18n),g(this,bt)[bt]=this.store.subscribe((i,o,n)=>{this.emit("state-update",i,o,n),this.updateAll(o)}),this.opts.debug&&typeof window<"u"&&(window[this.opts.id]=this),g(this,Xr)[Xr]()}emit(e){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];g(this,ye)[ye].emit(e,...s)}on(e,r){return g(this,ye)[ye].on(e,r),this}once(e,r){return g(this,ye)[ye].once(e,r),this}off(e,r){return g(this,ye)[ye].off(e,r),this}updateAll(e){this.iteratePlugins(r=>{r.update(e)})}setState(e){this.store.setState(e)}getState(){return this.store.getState()}patchFilesState(e){let r=this.getState().files;this.setState({files:{...r,...Object.fromEntries(Object.entries(e).map(s=>{let[i,o]=s;return[i,{...r[i],...o}]}))}})}setFileState(e,r){if(!this.getState().files[e])throw new Error(`Can\u2019t set state for ${e} (the file could have been removed)`);this.patchFilesState({[e]:r})}i18nInit(){let e=s=>this.log(`Missing i18n string: ${s}`,"error"),r=new Ne([this.defaultLocale,this.opts.locale],{onMissingKey:e});this.i18n=r.translate.bind(r),this.i18nArray=r.translateArray.bind(r),this.locale=r.locale}setOptions(e){this.opts={...this.opts,...e,restrictions:{...this.opts.restrictions,...e?.restrictions}},e.meta&&this.setMeta(e.meta),this.i18nInit(),e.locale&&this.iteratePlugins(r=>{r.setOptions(e)}),this.setState(void 0)}resetProgress(){let e={percentage:0,bytesUploaded:0,uploadComplete:!1,uploadStarted:null},r={...this.getState().files},s={};Object.keys(r).forEach(i=>{s[i]={...r[i],progress:{...r[i].progress,...e}}}),this.setState({files:s,...dr}),this.emit("reset-progress")}clearUploadedFiles(){this.setState({...dr,files:{}})}addPreProcessor(e){g(this,Be)[Be].add(e)}removePreProcessor(e){return g(this,Be)[Be].delete(e)}addPostProcessor(e){g(this,be)[be].add(e)}removePostProcessor(e){return g(this,be)[be].delete(e)}addUploader(e){g(this,Le)[Le].add(e)}removeUploader(e){return g(this,Le)[Le].delete(e)}setMeta(e){let r={...this.getState().meta,...e},s={...this.getState().files};Object.keys(s).forEach(i=>{s[i]={...s[i],meta:{...s[i].meta,...e}}}),this.log("Adding metadata:"),this.log(e),this.setState({meta:r,files:s})}setFileMeta(e,r){let s={...this.getState().files};if(!s[e]){this.log("Was trying to set metadata for a file that has been removed: ",e);return}let i={...s[e].meta,...r};s[e]={...s[e],meta:i},this.setState({files:s})}getFile(e){return this.getState().files[e]}getFiles(){let{files:e}=this.getState();return Object.values(e)}getFilesByIds(e){return e.map(r=>this.getFile(r))}getObjectOfFilesPerState(){let{files:e,totalProgress:r,error:s}=this.getState(),i=Object.values(e),o=i.filter(f=>{let{progress:S}=f;return!S.uploadComplete&&S.uploadStarted}),n=i.filter(f=>!f.progress.uploadStarted),a=i.filter(f=>f.progress.uploadStarted||f.progress.preprocess||f.progress.postprocess),l=i.filter(f=>f.progress.uploadStarted),d=i.filter(f=>f.isPaused),p=i.filter(f=>f.progress.uploadComplete),u=i.filter(f=>f.error),h=o.filter(f=>!f.isPaused),c=i.filter(f=>f.progress.preprocess||f.progress.postprocess);return{newFiles:n,startedFiles:a,uploadStartedFiles:l,pausedFiles:d,completeFiles:p,erroredFiles:u,inProgressFiles:o,inProgressNotPausedFiles:h,processingFiles:c,isUploadStarted:l.length>0,isAllComplete:r===100&&p.length===i.length&&c.length===0,isAllErrored:!!s&&u.length===i.length,isAllPaused:o.length!==0&&d.length===o.length,isUploadInProgress:o.length>0,isSomeGhost:i.some(f=>f.isGhost)}}validateRestrictions(e,r){r===void 0&&(r=this.getFiles());try{g(this,te)[te].validate(r,[e])}catch(s){return s}return null}checkIfFileAlreadyExists(e){let{files:r}=this.getState();return!!(r[e]&&!r[e].isGhost)}addFile(e){g(this,wt)[wt](e);let{nextFilesState:r,validFilesToAdd:s,errors:i}=g(this,Pt)[Pt]([e]),o=i.filter(a=>a.isRestriction);if(g(this,re)[re](o),i.length>0)throw i[0];this.setState({files:r});let[n]=s;return this.emit("file-added",n),this.emit("files-added",s),this.log(`Added file: ${n.name}, ${n.id}, mime type: ${n.type}`),g(this,St)[St](),n.id}addFiles(e){g(this,wt)[wt]();let{nextFilesState:r,validFilesToAdd:s,errors:i}=g(this,Pt)[Pt](e),o=i.filter(a=>a.isRestriction);g(this,re)[re](o);let n=i.filter(a=>!a.isRestriction);if(n.length>0){let a=`Multiple errors occurred while adding files:
`;if(n.forEach(l=>{a+=`
 * ${l.message}`}),this.info({message:this.i18n("addBulkFilesFailed",{smart_count:n.length}),details:a},"error",this.opts.infoTimeout),typeof AggregateError=="function")throw new AggregateError(n,a);{let l=new Error(a);throw l.errors=n,l}}this.setState({files:r}),s.forEach(a=>{this.emit("file-added",a)}),this.emit("files-added",s),s.length>5?this.log(`Added batch of ${s.length} files`):Object.values(s).forEach(a=>{this.log(`Added file: ${a.name}
 id: ${a.id}
 type: ${a.type}`)}),s.length>0&&g(this,St)[St]()}removeFiles(e,r){let{files:s,currentUploads:i}=this.getState(),o={...s},n={...i},a=Object.create(null);e.forEach(u=>{s[u]&&(a[u]=s[u],delete o[u])});function l(u){return a[u]===void 0}Object.keys(n).forEach(u=>{let h=i[u].fileIDs.filter(l);if(h.length===0){delete n[u];return}let{capabilities:c}=this.getState();if(h.length!==i[u].fileIDs.length&&!c.individualCancellation)throw new Error("individualCancellation is disabled");n[u]={...i[u],fileIDs:h}});let d={currentUploads:n,files:o};Object.keys(o).length===0&&(d.allowNewUpload=!0,d.error=null,d.recoveredState=null),this.setState(d),this.calculateTotalProgress();let p=Object.keys(a);p.forEach(u=>{this.emit("file-removed",a[u],r)}),p.length>5?this.log(`Removed ${p.length} files`):this.log(`Removed files: ${p.join(", ")}`)}removeFile(e,r){this.removeFiles([e],r)}pauseResume(e){if(!this.getState().capabilities.resumableUploads||this.getFile(e).progress.uploadComplete)return;let s=!(this.getFile(e).isPaused||!1);return this.setFileState(e,{isPaused:s}),this.emit("upload-pause",e,s),s}pauseAll(){let e={...this.getState().files};Object.keys(e).filter(s=>!e[s].progress.uploadComplete&&e[s].progress.uploadStarted).forEach(s=>{let i={...e[s],isPaused:!0};e[s]=i}),this.setState({files:e}),this.emit("pause-all")}resumeAll(){let e={...this.getState().files};Object.keys(e).filter(s=>!e[s].progress.uploadComplete&&e[s].progress.uploadStarted).forEach(s=>{let i={...e[s],isPaused:!1,error:null};e[s]=i}),this.setState({files:e}),this.emit("resume-all")}retryAll(){let e={...this.getState().files},r=Object.keys(e).filter(i=>e[i].error);if(r.forEach(i=>{let o={...e[i],isPaused:!1,error:null};e[i]=o}),this.setState({files:e,error:null}),this.emit("retry-all",r),r.length===0)return Promise.resolve({successful:[],failed:[]});let s=g(this,ve)[ve](r,{forceAllowNewUpload:!0});return g(this,_e)[_e](s)}cancelAll(e){let{reason:r="user"}=e===void 0?{}:e;if(this.emit("cancel-all",{reason:r}),r==="user"){let{files:s}=this.getState(),i=Object.keys(s);i.length&&this.removeFiles(i,"cancel-all"),this.setState(dr)}}retryUpload(e){this.setFileState(e,{error:null,isPaused:!1}),this.emit("upload-retry",e);let r=g(this,ve)[ve]([e],{forceAllowNewUpload:!0});return g(this,_e)[_e](r)}logout(){this.iteratePlugins(e=>{var r;(r=e.provider)==null||r.logout==null||r.logout()})}calculateTotalProgress(){let r=this.getFiles().filter(d=>d.progress.uploadStarted||d.progress.preprocess||d.progress.postprocess);if(r.length===0){this.emit("progress",0),this.setState({totalProgress:0});return}let s=r.filter(d=>d.progress.bytesTotal!=null),i=r.filter(d=>d.progress.bytesTotal==null);if(s.length===0){let d=r.length*100,p=i.reduce((h,c)=>h+c.progress.percentage,0),u=Math.round(p/d*100);this.setState({totalProgress:u});return}let o=s.reduce((d,p)=>{var u;return d+((u=p.progress.bytesTotal)!=null?u:0)},0),n=o/s.length;o+=n*i.length;let a=0;s.forEach(d=>{a+=d.progress.bytesUploaded}),i.forEach(d=>{a+=n*(d.progress.percentage||0)/100});let l=o===0?0:Math.round(a/o*100);l>100&&(l=100),this.setState({totalProgress:l}),this.emit("progress",l)}updateOnlineStatus(){var e;((e=window.navigator.onLine)!=null?e:!0)?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)}getID(){return this.opts.id}use(e,r){if(typeof e!="function"){let n=`Expected a plugin class, but got ${e===null?"null":typeof e}. Please verify that the plugin was imported and spelled correctly.`;throw new TypeError(n)}let s=new e(this,r),i=s.id;if(!i)throw new Error("Your plugin must have an id");if(!s.type)throw new Error("Your plugin must have a type");let o=this.getPlugin(i);if(o){let n=`Already found a plugin named '${o.id}'. Tried to use: '${i}'.
Uppy plugins must have unique \`id\` options. See https://uppy.io/docs/plugins/#id.`;throw new Error(n)}return e.VERSION&&this.log(`Using ${i} v${e.VERSION}`),s.type in g(this,q)[q]?g(this,q)[q][s.type].push(s):g(this,q)[q][s.type]=[s],s.install(),this.emit("plugin-added",s),this}getPlugin(e){for(let r of Object.values(g(this,q)[q])){let s=r.find(i=>i.id===e);if(s!=null)return s}}[Xi](e){return g(this,q)[q][e]}iteratePlugins(e){Object.values(g(this,q)[q]).flat(1).forEach(e)}removePlugin(e){this.log(`Removing plugin ${e.id}`),this.emit("plugin-remove",e),e.uninstall&&e.uninstall();let r=g(this,q)[q][e.type],s=r.findIndex(n=>n.id===e.id);s!==-1&&r.splice(s,1);let o={plugins:{...this.getState().plugins,[e.id]:void 0}};this.setState(o)}close(e){let{reason:r}=e===void 0?{}:e;this.log(`Closing Uppy instance ${this.opts.id}: removing all files and uninstalling plugins`),this.cancelAll({reason:r}),g(this,bt)[bt](),this.iteratePlugins(s=>{this.removePlugin(s)}),typeof window<"u"&&window.removeEventListener&&(window.removeEventListener("online",g(this,ce)[ce]),window.removeEventListener("offline",g(this,ce)[ce]))}hideInfo(){let{info:e}=this.getState();this.setState({info:e.slice(1)}),this.emit("info-hidden")}info(e,r,s){r===void 0&&(r="info"),s===void 0&&(s=3e3);let i=typeof e=="object";this.setState({info:[...this.getState().info,{type:r,message:i?e.message:e,details:i?e.details:null}]}),setTimeout(()=>this.hideInfo(),s),this.emit("info-visible")}log(e,r){let{logger:s}=this.opts;switch(r){case"error":s.error(e);break;case"warning":s.warn(e);break;default:s.debug(e);break}}registerRequestClient(e,r){g(this,Tt)[Tt].set(e,r)}getRequestClientForFile(e){if(!e.remote)throw new Error(`Tried to get RequestClient for a non-remote file ${e.id}`);let r=g(this,Tt)[Tt].get(e.remote.requestClientId);if(r==null)throw new Error(`requestClientId "${e.remote.requestClientId}" not registered for file "${e.id}"`);return r}restore(e){return this.log(`Core: attempting to restore upload "${e}"`),this.getState().currentUploads[e]?g(this,_e)[_e](e):(g(this,Ie)[Ie](e),Promise.reject(new Error("Nonexistent upload")))}[Ji](){return g(this,ve)[ve](...arguments)}addResultData(e,r){if(!g(this,Jr)[Jr](e)){this.log(`Not setting result for an upload that has been removed: ${e}`);return}let{currentUploads:s}=this.getState(),i={...s[e],result:{...s[e].result,...r}};this.setState({currentUploads:{...s,[e]:i}})}upload(){var e;(e=g(this,q)[q].uploader)!=null&&e.length||this.log("No uploader type plugins are used","warning");let{files:r}=this.getState(),s=this.opts.onBeforeUpload(r);return s===!1?Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false")):(s&&typeof s=="object"&&(r=s,this.setState({files:r})),Promise.resolve().then(()=>g(this,te)[te].validateMinNumberOfFiles(r)).catch(i=>{throw g(this,re)[re]([i]),i}).then(()=>{if(!g(this,Wr)[Wr](r))throw new Z(this.i18n("missingRequiredMetaField"))}).catch(i=>{throw i}).then(()=>{let{currentUploads:i}=this.getState(),o=Object.values(i).flatMap(l=>l.fileIDs),n=[];Object.keys(r).forEach(l=>{let d=this.getFile(l);!d.progress.uploadStarted&&o.indexOf(l)===-1&&n.push(d.id)});let a=g(this,ve)[ve](n);return g(this,_e)[_e](a)}).catch(i=>{throw this.emit("error",i),this.log(i,"error"),i}))}};function Fa(t){for(let o of t)o.isRestriction?this.emit("restriction-failed",o.file,o):this.emit("error",o,o.file),this.log(o,"warning");let e=t.filter(o=>o.isUserFacing),r=4,s=e.slice(0,r),i=e.slice(r);s.forEach(o=>{let{message:n,details:a=""}=o;this.info({message:n,details:a},"error",this.opts.infoTimeout)}),i.length>0&&this.info({message:this.i18n("additionalRestrictionsFailed",{count:i.length})})}function Ea(t){let{missingFields:e,error:r}=g(this,te)[te].getMissingRequiredMetaFields(t);return e.length>0?(this.setFileState(t.id,{missingRequiredMetaFields:e}),this.log(r.message),this.emit("restriction-failed",t,r),!1):!0}function Ua(t){let e=!0;for(let r of Object.values(t))g(this,Ft)[Ft](r)||(e=!1);return e}function Oa(t){let{allowNewUpload:e}=this.getState();if(e===!1){let r=new Z(this.i18n("noMoreFilesAllowed"),{file:t});throw g(this,re)[re]([r]),r}}function xa(t){let e=t instanceof File?{name:t.name,type:t.type,size:t.size,data:t}:t,r=_t(e),s=Hr(r,e),i=vt(s).extension,o=Ni(e),n=e.meta||{};n.name=s,n.type=r;let a=Number.isFinite(e.data.size)?e.data.size:null;return{source:e.source||"",id:o,name:s,extension:i||"",meta:{...this.getState().meta,...n},type:r,data:e.data,progress:{percentage:0,bytesUploaded:0,bytesTotal:a,uploadComplete:!1,uploadStarted:null},size:a,isGhost:!1,isRemote:e.isRemote||!1,remote:e.remote||"",preview:e.preview}}function Aa(){this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout(()=>{this.scheduledAutoProceed=null,this.upload().catch(t=>{t.isRestriction||this.log(t.stack||t.message||t)})},4))}function Ca(t){let{files:e}=this.getState(),r={...e},s=[],i=[];for(let n of t)try{var o;let a=g(this,Vr)[Vr](n),l=(o=e[a.id])==null?void 0:o.isGhost;l&&(a={...e[a.id],isGhost:!1,data:n.data},this.log(`Replaced the blob in the restored ghost file: ${a.name}, ${a.id}`));let d=this.opts.onBeforeFileAdded(a,r);if(!d&&this.checkIfFileAlreadyExists(a.id))throw new Z(this.i18n("noDuplicates",{fileName:a.name}),{file:n});if(d===!1&&!l)throw new Z("Cannot add the file because onBeforeFileAdded returned false.",{isUserFacing:!1,file:n});typeof d=="object"&&d!==null&&(a=d),g(this,te)[te].validateSingleFile(a),r[a.id]=a,s.push(a)}catch(a){i.push(a)}try{g(this,te)[te].validateAggregateRestrictions(Object.values(e),s)}catch(n){return i.push(n),{nextFilesState:e,validFilesToAdd:[],errors:i}}return{nextFilesState:r,validFilesToAdd:s,errors:i}}function ka(){let t=(s,i,o)=>{let n=s.message||"Unknown error";s.details&&(n+=` ${s.details}`),this.setState({error:n}),i!=null&&i.id in this.getState().files&&this.setFileState(i.id,{error:n,response:o})};this.on("error",t),this.on("upload-error",(s,i,o)=>{if(t(i,s,o),typeof i=="object"&&i.message){var n;this.log(i.message,"error");let a=new Error(this.i18n("failedToUpload",{file:(n=s?.name)!=null?n:""}));a.isUserFacing=!0,a.details=i.message,i.details&&(a.details+=` ${i.details}`),g(this,re)[re]([a])}else g(this,re)[re]([i])});let e=null;this.on("upload-stalled",(s,i)=>{let{message:o}=s,n=i.map(a=>a.meta.name).join(", ");e||(this.info({message:o,details:n},"warning",this.opts.infoTimeout),e=setTimeout(()=>{e=null},this.opts.infoTimeout)),this.log(`${o} ${n}`.trim(),"warning")}),this.on("upload",()=>{this.setState({error:null})});let r=s=>{let i=s.filter(n=>{let a=n!=null&&this.getFile(n.id);return a||this.log(`Not setting progress for a file that has been removed: ${n?.id}`),a}),o=Object.fromEntries(i.map(n=>[n.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,percentage:0,bytesUploaded:0,bytesTotal:n.size}}]));this.patchFilesState(o)};this.on("upload-start",s=>{s.forEach(i=>{this.emit("upload-started",i)}),r(s)}),this.on("upload-progress",this.calculateProgress),this.on("upload-success",(s,i)=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s?.id}`);return}let o=this.getFile(s.id).progress;this.setFileState(s.id,{progress:{...o,postprocess:g(this,be)[be].size>0?{mode:"indeterminate"}:void 0,uploadComplete:!0,percentage:100,bytesUploaded:o.bytesTotal},response:i,uploadURL:i.uploadURL,isPaused:!1}),s.size==null&&this.setFileState(s.id,{size:i.bytesUploaded||o.bytesTotal}),this.calculateTotalProgress()}),this.on("preprocess-progress",(s,i)=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s?.id}`);return}this.setFileState(s.id,{progress:{...this.getFile(s.id).progress,preprocess:i}})}),this.on("preprocess-complete",s=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s?.id}`);return}let i={...this.getState().files};i[s.id]={...i[s.id],progress:{...i[s.id].progress}},delete i[s.id].progress.preprocess,this.setState({files:i})}),this.on("postprocess-progress",(s,i)=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s?.id}`);return}this.setFileState(s.id,{progress:{...this.getState().files[s.id].progress,postprocess:i}})}),this.on("postprocess-complete",s=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s?.id}`);return}let i={...this.getState().files};i[s.id]={...i[s.id],progress:{...i[s.id].progress}},delete i[s.id].progress.postprocess,this.setState({files:i})}),this.on("restored",()=>{this.calculateTotalProgress()}),this.on("dashboard:file-edit-complete",s=>{s&&g(this,Ft)[Ft](s)}),typeof window<"u"&&window.addEventListener&&(window.addEventListener("online",g(this,ce)[ce]),window.addEventListener("offline",g(this,ce)[ce]),setTimeout(g(this,ce)[ce],3e3))}function Ra(t,e){e===void 0&&(e={});let{forceAllowNewUpload:r=!1}=e,{allowNewUpload:s,currentUploads:i}=this.getState();if(!s&&!r)throw new Error("Cannot create a new upload: already uploading.");let o=Qs();return this.emit("upload",{id:o,fileIDs:t}),this.setState({allowNewUpload:this.opts.allowMultipleUploadBatches!==!1&&this.opts.allowMultipleUploads!==!1,currentUploads:{...i,[o]:{fileIDs:t,step:0,result:{}}}}),o}function $a(t){let{currentUploads:e}=this.getState();return e[t]}function ja(t){let e={...this.getState().currentUploads};delete e[t],this.setState({currentUploads:e})}async function Na(t){let e=()=>{let{currentUploads:o}=this.getState();return o[t]},r=e(),s=[...g(this,Be)[Be],...g(this,Le)[Le],...g(this,be)[be]];try{for(let o=r.step||0;o<s.length&&r;o++){let n=s[o];this.setState({currentUploads:{...this.getState().currentUploads,[t]:{...r,step:o}}});let{fileIDs:a}=r;await n(a,t),r=e()}}catch(o){throw g(this,Ie)[Ie](t),o}if(r){r.fileIDs.forEach(l=>{let d=this.getFile(l);d&&d.progress.postprocess&&this.emit("postprocess-complete",d)});let o=r.fileIDs.map(l=>this.getFile(l)),n=o.filter(l=>!l.error),a=o.filter(l=>l.error);this.addResultData(t,{successful:n,failed:a,uploadID:t}),r=e()}let i;return r&&(i=r.result,this.emit("complete",i),g(this,Ie)[Ie](t)),i==null&&this.log(`Not setting result for an upload that has been removed: ${t}`),i}pr.VERSION=Ta.version;var cr=pr;var yr,$,ro,Ma,De,Qi,so,Yr,ts,Qr,Zr,Ba,Et={},io=[],La=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,rs=Array.isArray;function Ce(t,e){for(var r in e)t[r]=e[r];return t}function oo(t){var e=t.parentNode;e&&e.removeChild(t)}function m(t,e,r){var s,i,o,n={};for(o in e)o=="key"?s=e[o]:o=="ref"?i=e[o]:n[o]=e[o];if(arguments.length>2&&(n.children=arguments.length>3?yr.call(arguments,2):r),typeof t=="function"&&t.defaultProps!=null)for(o in t.defaultProps)n[o]===void 0&&(n[o]=t.defaultProps[o]);return fr(t,n,s,i,null)}function fr(t,e,r,s,i){var o={type:t,props:e,key:r,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:i??++ro,__i:-1,__u:0};return i==null&&$.vnode!=null&&$.vnode(o),o}function vr(t){return t.children}function mr(t,e){this.props=t,this.context=e}function qe(t,e){if(e==null)return t.__?qe(t.__,t.__i+1):null;for(var r;e<t.__k.length;e++)if((r=t.__k[e])!=null&&r.__e!=null)return r.__e;return typeof t.type=="function"?qe(t):null}function no(t){var e,r;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((r=t.__k[e])!=null&&r.__e!=null){t.__e=t.__c.base=r.__e;break}return no(t)}}function Zi(t){(!t.__d&&(t.__d=!0)&&De.push(t)&&!gr.__r++||Qi!==$.debounceRendering)&&((Qi=$.debounceRendering)||so)(gr)}function gr(){var t,e,r,s,i,o,n,a;for(De.sort(Yr);t=De.shift();)t.__d&&(e=De.length,s=void 0,o=(i=(r=t).__v).__e,n=[],a=[],r.__P&&((s=Ce({},i)).__v=i.__v+1,$.vnode&&$.vnode(s),ss(r.__P,s,i,r.__n,r.__P.ownerSVGElement!==void 0,32&i.__u?[o]:null,n,o??qe(i),!!(32&i.__u),a),s.__v=i.__v,s.__.__k[s.__i]=s,uo(n,s,a),s.__e!=o&&no(s)),De.length>e&&De.sort(Yr));gr.__r=0}function ao(t,e,r,s,i,o,n,a,l,d,p){var u,h,c,f,S,_=s&&s.__k||io,v=e.length;for(r.__d=l,Ia(r,e,_),l=r.__d,u=0;u<v;u++)(c=r.__k[u])!=null&&typeof c!="boolean"&&typeof c!="function"&&(h=c.__i===-1?Et:_[c.__i]||Et,c.__i=u,ss(t,c,h,i,o,n,a,l,d,p),f=c.__e,c.ref&&h.ref!=c.ref&&(h.ref&&is(h.ref,null,c),p.push(c.ref,c.__c||f,c)),S==null&&f!=null&&(S=f),65536&c.__u||h.__k===c.__k?(l&&!l.isConnected&&(l=qe(h)),l=lo(c,l,t)):typeof c.type=="function"&&c.__d!==void 0?l=c.__d:f&&(l=f.nextSibling),c.__d=void 0,c.__u&=-196609);r.__d=l,r.__e=S}function Ia(t,e,r){var s,i,o,n,a,l=e.length,d=r.length,p=d,u=0;for(t.__k=[],s=0;s<l;s++)n=s+u,(i=t.__k[s]=(i=e[s])==null||typeof i=="boolean"||typeof i=="function"?null:typeof i=="string"||typeof i=="number"||typeof i=="bigint"||i.constructor==String?fr(null,i,null,null,null):rs(i)?fr(vr,{children:i},null,null,null):i.constructor===void 0&&i.__b>0?fr(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):i)!=null?(i.__=t,i.__b=t.__b+1,a=Da(i,r,n,p),i.__i=a,o=null,a!==-1&&(p--,(o=r[a])&&(o.__u|=131072)),o==null||o.__v===null?(a==-1&&u--,typeof i.type!="function"&&(i.__u|=65536)):a!==n&&(a===n+1?u++:a>n?p>l-n?u+=a-n:u--:a<n?a==n-1&&(u=a-n):u=0,a!==s+u&&(i.__u|=65536))):(o=r[n])&&o.key==null&&o.__e&&!(131072&o.__u)&&(o.__e==t.__d&&(t.__d=qe(o)),es(o,o,!1),r[n]=null,p--);if(p)for(s=0;s<d;s++)(o=r[s])!=null&&!(131072&o.__u)&&(o.__e==t.__d&&(t.__d=qe(o)),es(o,o))}function lo(t,e,r){var s,i;if(typeof t.type=="function"){for(s=t.__k,i=0;s&&i<s.length;i++)s[i]&&(s[i].__=t,e=lo(s[i],e,r));return e}t.__e!=e&&(r.insertBefore(t.__e,e||null),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType===8);return e}function Da(t,e,r,s){var i=t.key,o=t.type,n=r-1,a=r+1,l=e[r];if(l===null||l&&i==l.key&&o===l.type&&!(131072&l.__u))return r;if(s>(l!=null&&!(131072&l.__u)?1:0))for(;n>=0||a<e.length;){if(n>=0){if((l=e[n])&&!(131072&l.__u)&&i==l.key&&o===l.type)return n;n--}if(a<e.length){if((l=e[a])&&!(131072&l.__u)&&i==l.key&&o===l.type)return a;a++}}return-1}function eo(t,e,r){e[0]==="-"?t.setProperty(e,r??""):t[e]=r==null?"":typeof r!="number"||La.test(e)?r:r+"px"}function hr(t,e,r,s,i){var o;e:if(e==="style")if(typeof r=="string")t.style.cssText=r;else{if(typeof s=="string"&&(t.style.cssText=s=""),s)for(e in s)r&&e in r||eo(t.style,e,"");if(r)for(e in r)s&&r[e]===s[e]||eo(t.style,e,r[e])}else if(e[0]==="o"&&e[1]==="n")o=e!==(e=e.replace(/(PointerCapture)$|Capture$/i,"$1")),e=e.toLowerCase()in t||e==="onFocusOut"||e==="onFocusIn"?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+o]=r,r?s?r.u=s.u:(r.u=ts,t.addEventListener(e,o?Zr:Qr,o)):t.removeEventListener(e,o?Zr:Qr,o);else{if(i)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e in t)try{t[e]=r??"";break e}catch{}typeof r=="function"||(r==null||r===!1&&e[4]!=="-"?t.removeAttribute(e):t.setAttribute(e,r))}}function to(t){return function(e){if(this.l){var r=this.l[e.type+t];if(e.t==null)e.t=ts++;else if(e.t<r.u)return;return r($.event?$.event(e):e)}}}function ss(t,e,r,s,i,o,n,a,l,d){var p,u,h,c,f,S,_,v,F,x,A,R,E,P,U,O=e.type;if(e.constructor!==void 0)return null;128&r.__u&&(l=!!(32&r.__u),o=[a=e.__e=r.__e]),(p=$.__b)&&p(e);e:if(typeof O=="function")try{if(v=e.props,F=(p=O.contextType)&&s[p.__c],x=p?F?F.props.value:p.__:s,r.__c?_=(u=e.__c=r.__c).__=u.__E:("prototype"in O&&O.prototype.render?e.__c=u=new O(v,x):(e.__c=u=new mr(v,x),u.constructor=O,u.render=za),F&&F.sub(u),u.props=v,u.state||(u.state={}),u.context=x,u.__n=s,h=u.__d=!0,u.__h=[],u._sb=[]),u.__s==null&&(u.__s=u.state),O.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=Ce({},u.__s)),Ce(u.__s,O.getDerivedStateFromProps(v,u.__s))),c=u.props,f=u.state,u.__v=e,h)O.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(O.getDerivedStateFromProps==null&&v!==c&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(v,x),!u.__e&&(u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(v,u.__s,x)===!1||e.__v===r.__v)){for(e.__v!==r.__v&&(u.props=v,u.state=u.__s,u.__d=!1),e.__e=r.__e,e.__k=r.__k,e.__k.forEach(function(Q){Q&&(Q.__=e)}),A=0;A<u._sb.length;A++)u.__h.push(u._sb[A]);u._sb=[],u.__h.length&&n.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(v,u.__s,x),u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(c,f,S)})}if(u.context=x,u.props=v,u.__P=t,u.__e=!1,R=$.__r,E=0,"prototype"in O&&O.prototype.render){for(u.state=u.__s,u.__d=!1,R&&R(e),p=u.render(u.props,u.state,u.context),P=0;P<u._sb.length;P++)u.__h.push(u._sb[P]);u._sb=[]}else do u.__d=!1,R&&R(e),p=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++E<25);u.state=u.__s,u.getChildContext!=null&&(s=Ce(Ce({},s),u.getChildContext())),h||u.getSnapshotBeforeUpdate==null||(S=u.getSnapshotBeforeUpdate(c,f)),ao(t,rs(U=p!=null&&p.type===vr&&p.key==null?p.props.children:p)?U:[U],e,r,s,i,o,n,a,l,d),u.base=e.__e,e.__u&=-161,u.__h.length&&n.push(u),_&&(u.__E=u.__=null)}catch(Q){e.__v=null,l||o!=null?(e.__e=a,e.__u|=l?160:32,o[o.indexOf(a)]=null):(e.__e=r.__e,e.__k=r.__k),$.__e(Q,e,r)}else o==null&&e.__v===r.__v?(e.__k=r.__k,e.__e=r.__e):e.__e=qa(r.__e,e,r,s,i,o,n,l,d);(p=$.diffed)&&p(e)}function uo(t,e,r){e.__d=void 0;for(var s=0;s<r.length;s++)is(r[s],r[++s],r[++s]);$.__c&&$.__c(e,t),t.some(function(i){try{t=i.__h,i.__h=[],t.some(function(o){o.call(i)})}catch(o){$.__e(o,i.__v)}})}function qa(t,e,r,s,i,o,n,a,l){var d,p,u,h,c,f,S,_=r.props,v=e.props,F=e.type;if(F==="svg"&&(i=!0),o!=null){for(d=0;d<o.length;d++)if((c=o[d])&&"setAttribute"in c==!!F&&(F?c.localName===F:c.nodeType===3)){t=c,o[d]=null;break}}if(t==null){if(F===null)return document.createTextNode(v);t=i?document.createElementNS("http://www.w3.org/2000/svg",F):document.createElement(F,v.is&&v),o=null,a=!1}if(F===null)_===v||a&&t.data===v||(t.data=v);else{if(o=o&&yr.call(t.childNodes),_=r.props||Et,!a&&o!=null)for(_={},d=0;d<t.attributes.length;d++)_[(c=t.attributes[d]).name]=c.value;for(d in _)c=_[d],d=="children"||(d=="dangerouslySetInnerHTML"?u=c:d==="key"||d in v||hr(t,d,null,c,i));for(d in v)c=v[d],d=="children"?h=c:d=="dangerouslySetInnerHTML"?p=c:d=="value"?f=c:d=="checked"?S=c:d==="key"||a&&typeof c!="function"||_[d]===c||hr(t,d,c,_[d],i);if(p)a||u&&(p.__html===u.__html||p.__html===t.innerHTML)||(t.innerHTML=p.__html),e.__k=[];else if(u&&(t.innerHTML=""),ao(t,rs(h)?h:[h],e,r,s,i&&F!=="foreignObject",o,n,o?o[0]:r.__k&&qe(r,0),a,l),o!=null)for(d=o.length;d--;)o[d]!=null&&oo(o[d]);a||(d="value",f!==void 0&&(f!==t[d]||F==="progress"&&!f||F==="option"&&f!==_[d])&&hr(t,d,f,_[d],!1),d="checked",S!==void 0&&S!==t[d]&&hr(t,d,S,_[d],!1))}return t}function is(t,e,r){try{typeof t=="function"?t(e):t.current=e}catch(s){$.__e(s,r)}}function es(t,e,r){var s,i;if($.unmount&&$.unmount(t),(s=t.ref)&&(s.current&&s.current!==t.__e||is(s,null,e)),(s=t.__c)!=null){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(o){$.__e(o,e)}s.base=s.__P=null}if(s=t.__k)for(i=0;i<s.length;i++)s[i]&&es(s[i],e,r||typeof t.type!="function");r||t.__e==null||oo(t.__e),t.__c=t.__=t.__e=t.__d=void 0}function za(t,e,r){return this.constructor(t,r)}function os(t,e,r){var s,i,o,n;$.__&&$.__(t,e),i=(s=typeof r=="function")?null:r&&r.__k||e.__k,o=[],n=[],ss(e,t=(!s&&r||e).__k=m(vr,null,[t]),i||Et,Et,e.ownerSVGElement!==void 0,!s&&r?[r]:i?null:e.firstChild?yr.call(e.childNodes):null,o,!s&&r?r:i?i.__e:e.firstChild,s,n),uo(o,t,n)}yr=io.slice,$={__e:function(t,e,r,s){for(var i,o,n;e=e.__;)if((i=e.__c)&&!i.__)try{if((o=i.constructor)&&o.getDerivedStateFromError!=null&&(i.setState(o.getDerivedStateFromError(t)),n=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(t,s||{}),n=i.__d),n)return i.__E=i}catch(a){t=a}throw t}},ro=0,Ma=function(t){return t!=null&&t.constructor==null},mr.prototype.setState=function(t,e){var r;r=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Ce({},this.state),typeof t=="function"&&(t=t(Ce({},r),this.props)),t&&Ce(r,t),t!=null&&this.__v&&(e&&this._sb.push(e),Zi(this))},mr.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),Zi(this))},mr.prototype.render=vr,De=[],so=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Yr=function(t,e){return t.__v.__b-e.__v.__b},gr.__r=0,ts=0,Qr=to(!1),Zr=to(!0),Ba=0;function ns(t){return typeof t!="object"||t===null||!("nodeType"in t)?!1:t.nodeType===Node.ELEMENT_NODE}function Ha(t,e){return e===void 0&&(e=document),typeof t=="string"?e.querySelector(t):ns(t)?t:null}var po=Ha;function Ga(t){for(var e;t&&!t.dir;)t=t.parentNode;return(e=t)==null?void 0:e.dir}var _r=Ga;var ze=class{constructor(e,r){this.uppy=e,this.opts=r??{}}getPluginState(){let{plugins:e}=this.uppy.getState();return e?.[this.id]||{}}setPluginState(e){let{plugins:r}=this.uppy.getState();this.uppy.setState({plugins:{...r,[this.id]:{...r[this.id],...e}}})}setOptions(e){this.opts={...this.opts,...e},this.setPluginState(void 0),this.i18nInit()}i18nInit(){let e=new Ne([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.setPluginState(void 0)}addTarget(e){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")}install(){}uninstall(){}update(e){}afterUpdate(){}};function co(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var Ka=0;function Wa(t){return"__private_"+Ka+++"_"+t}function Xa(t){let e=null,r;return function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return r=i,e||(e=Promise.resolve().then(()=>(e=null,t(...r)))),e}}var Ut=Wa("updateUI"),as=class t extends ze{constructor(){super(...arguments),Object.defineProperty(this,Ut,{writable:!0,value:void 0})}getTargetPlugin(e){let r;if(typeof e?.addTarget=="function")r=e,r instanceof t||console.warn(new Error("The provided plugin is not an instance of UIPlugin. This is an indication of a bug with the way Uppy is bundled.",{cause:{targetPlugin:r,UIPlugin:t}}));else if(typeof e=="function"){let s=e;this.uppy.iteratePlugins(i=>{i instanceof s&&(r=i)})}return r}mount(e,r){let s=r.id,i=po(e);if(i){this.isTargetDOMEl=!0;let a=document.createElement("div");return a.classList.add("uppy-Root"),co(this,Ut)[Ut]=Xa(l=>{this.uppy.getPlugin(this.id)&&(os(this.render(l),a),this.afterUpdate())}),this.uppy.log(`Installing ${s} to a DOM element '${e}'`),this.opts.replaceTargetContent&&(i.innerHTML=""),os(this.render(this.uppy.getState()),a),this.el=a,i.appendChild(a),a.dir=this.opts.direction||_r(a)||"ltr",this.onMount(),this.el}let o=this.getTargetPlugin(e);if(o)return this.uppy.log(`Installing ${s} to ${o.id}`),this.parent=o,this.el=o.addTarget(r),this.onMount(),this.el;this.uppy.log(`Not installing ${s}`);let n=`Invalid target option given to ${s}.`;throw typeof e=="function"?n+=" The given target is not a Plugin class. Please check that you're not specifying a React Component instead of a plugin. If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.":n+="If you meant to target an HTML element, please make sure that the element exists. Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. (see https://github.com/transloadit/uppy/issues/1042)\n\nIf you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.",new Error(n)}render(e){throw new Error("Extend the render method to add your plugin to a DOM element")}update(e){if(this.el!=null){var r,s;(r=(s=co(this,Ut))[Ut])==null||r.call(s,e)}}unmount(){if(this.isTargetDOMEl){var e;(e=this.el)==null||e.remove()}this.onUnmount()}onMount(){}onUnmount(){}},Ot=as;var br=Array.from;function ls(){let t=document.body;return!(!("draggable"in t)||!("ondragstart"in t&&"ondrop"in t)||!("FormData"in window)||!("FileReader"in window))}function wr(t,e,r,s){let{onSuccess:i}=s;t.readEntries(o=>{let n=[...e,...o];o.length?queueMicrotask(()=>{wr(t,n,r,{onSuccess:i})}):i(n)},o=>{r(o),i(e)})}function ho(t,e){return t==null?t:{kind:t.isFile?"file":t.isDirectory?"directory":void 0,name:t.name,getFile(){return new Promise((r,s)=>t.file(r,s))},async*values(){let r=t.createReader();yield*await new Promise(i=>{wr(r,[],e,{onSuccess:o=>i(o.map(n=>ho(n,e)))})})},isSameEntry:void 0}}function fo(t,e,r){try{return r===void 0&&(r=void 0),async function*(){let s=()=>`${e}/${t.name}`;if(t.kind==="file"){let i=await t.getFile();i!=null?(i.relativePath=e?s():null,yield i):r!=null&&(yield r)}else if(t.kind==="directory")for await(let i of t.values())yield*fo(i,e?s():t.name);else r!=null&&(yield r)}()}catch(s){return Promise.reject(s)}}async function*us(t,e){let r=await Promise.all(Array.from(t.items,async s=>{var i;let o,n=()=>typeof s.getAsEntry=="function"?s.getAsEntry():s.webkitGetAsEntry();return(i=o)!=null||(o=ho(n(),e)),{fileSystemHandle:o,lastResortFile:s.getAsFile()}}));for(let{lastResortFile:s,fileSystemHandle:i}of r)if(i!=null)try{yield*fo(i,"",s)}catch(o){s!=null?yield s:e(o)}else s!=null&&(yield s)}function ds(t){let e=br(t.files);return Promise.resolve(e)}async function ps(t,e){var r;let s=(r=e?.logDropError)!=null?r:Function.prototype;try{let i=[];for await(let o of us(t,s))i.push(o);return i}catch{return ds(t)}}var mo={strings:{dropHereOr:"Drop here or %{browse}",browse:"browse"}};var Ja={version:"3.1.0"},Va={inputName:"files[]",width:"100%",height:"100%"},ke=class t extends Ot{constructor(e,r){super(e,{...Va,...r}),this.isDragDropSupported=ls(),this.addFiles=s=>{let i=s.map(o=>({source:this.id,name:o.name,type:o.type,data:o,meta:{relativePath:o.relativePath||null}}));try{this.uppy.addFiles(i)}catch(o){this.uppy.log(o)}},this.onInputChange=s=>{let i=br(s.target.files);i.length>0&&(this.uppy.log("[DragDrop] Files selected through input"),this.addFiles(i)),s.target.value=null},this.handleDragOver=s=>{var i,o;s.preventDefault(),s.stopPropagation();let{types:n}=s.dataTransfer,a=n.some(d=>d==="Files"),{allowNewUpload:l}=this.uppy.getState();if(!a||!l){s.dataTransfer.dropEffect="none",clearTimeout(this.removeDragOverClassTimeout);return}s.dataTransfer.dropEffect="copy",clearTimeout(this.removeDragOverClassTimeout),this.setPluginState({isDraggingOver:!0}),(i=(o=this.opts).onDragOver)==null||i.call(o,s)},this.handleDragLeave=s=>{var i,o;s.preventDefault(),s.stopPropagation(),clearTimeout(this.removeDragOverClassTimeout),this.removeDragOverClassTimeout=setTimeout(()=>{this.setPluginState({isDraggingOver:!1})},50),(i=(o=this.opts).onDragLeave)==null||i.call(o,s)},this.handleDrop=async s=>{var i,o;s.preventDefault(),s.stopPropagation(),clearTimeout(this.removeDragOverClassTimeout),this.setPluginState({isDraggingOver:!1});let n=l=>{this.uppy.log(l,"error")},a=await ps(s.dataTransfer,{logDropError:n});a.length>0&&(this.uppy.log("[DragDrop] Files dropped"),this.addFiles(a)),(i=(o=this.opts).onDrop)==null||i.call(o,s)},this.type="acquirer",this.id=this.opts.id||"DragDrop",this.title="Drag & Drop",this.defaultLocale=mo,this.i18nInit()}renderHiddenFileInput(){let{restrictions:e}=this.uppy.opts;return m("input",{className:"uppy-DragDrop-input",type:"file",hidden:!0,ref:r=>{this.fileInputRef=r},name:this.opts.inputName,multiple:e.maxNumberOfFiles!==1,accept:e.allowedFileTypes,onChange:this.onInputChange})}static renderArrowSvg(){return m("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-DragDrop-arrow",width:"16",height:"16",viewBox:"0 0 16 16"},m("path",{d:"M11 10V0H5v10H2l6 6 6-6h-3zm0 0",fillRule:"evenodd"}))}renderLabel(){return m("div",{className:"uppy-DragDrop-label"},this.i18nArray("dropHereOr",{browse:m("span",{className:"uppy-DragDrop-browse"},this.i18n("browse"))}))}renderNote(){return m("span",{className:"uppy-DragDrop-note"},this.opts.note)}render(){let e=`uppy-u-reset
      uppy-DragDrop-container
      ${this.isDragDropSupported?"uppy-DragDrop--isDragDropSupported":""}
      ${this.getPluginState().isDraggingOver?"uppy-DragDrop--isDraggingOver":""}
    `,r={width:this.opts.width,height:this.opts.height};return m("button",{type:"button",className:e,style:r,onClick:()=>this.fileInputRef.click(),onDragOver:this.handleDragOver,onDragLeave:this.handleDragLeave,onDrop:this.handleDrop},this.renderHiddenFileInput(),m("div",{className:"uppy-DragDrop-inner"},t.renderArrowSvg(),this.renderLabel(),this.renderNote()))}install(){let{target:e}=this.opts;this.setPluginState({isDraggingOver:!1}),e&&this.mount(e,this)}uninstall(){this.unmount()}};ke.VERSION=Ja.version;function Sr(t,e,r,s){return r===0||t===e?t:s===0?e:t+(e-t)*2**(-s/r)}var se={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete"};var _s=ge(cs(),1);function xt(t){let e=[],r="indeterminate",s;for(let{progress:o}of Object.values(t)){let{preprocess:n,postprocess:a}=o;s==null&&(n||a)&&({mode:r,message:s}=n||a),n?.mode==="determinate"&&e.push(n.value),a?.mode==="determinate"&&e.push(a.value)}let i=e.reduce((o,n)=>o+n/e.length,0);return{mode:r,message:s,value:i}}var gs=ge(cs(),1),ms=ge(Kr(),1);function hs(t){let e=Math.floor(t/3600)%24,r=Math.floor(t/60)%60,s=Math.floor(t%60);return{hours:e,minutes:r,seconds:s}}function fs(t){let e=hs(t),r=e.hours===0?"":`${e.hours}h`,s=e.minutes===0?"":`${e.hours===0?e.minutes:` ${e.minutes.toString(10).padStart(2,"0")}`}m`,i=e.hours!==0?"":`${e.minutes===0?e.seconds:` ${e.seconds.toString(10).padStart(2,"0")}`}s`;return`${r}${s}${i}`}var Ya="\xB7",go=()=>` ${Ya} `;function yo(t){let{newFiles:e,isUploadStarted:r,recoveredState:s,i18n:i,uploadState:o,isSomeGhost:n,startUpload:a}=t,l=(0,gs.default)("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--upload",{"uppy-c-btn-primary":o===se.STATE_WAITING},{"uppy-StatusBar-actionBtn--disabled":n}),d=e&&r&&!s?i("uploadXNewFiles",{smart_count:e}):i("uploadXFiles",{smart_count:e});return m("button",{type:"button",className:l,"aria-label":i("uploadXFiles",{smart_count:e}),onClick:a,disabled:n,"data-uppy-super-focusable":!0},d)}function vo(t){let{i18n:e,uppy:r}=t;return m("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--retry","aria-label":e("retryUpload"),onClick:()=>r.retryAll().catch(()=>{}),"data-uppy-super-focusable":!0,"data-cy":"retry"},m("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"8",height:"10",viewBox:"0 0 8 10"},m("path",{d:"M4 2.408a2.75 2.75 0 1 0 2.75 2.75.626.626 0 0 1 1.25.018v.023a4 4 0 1 1-4-4.041V.25a.25.25 0 0 1 .389-.208l2.299 1.533a.25.25 0 0 1 0 .416l-2.3 1.533A.25.25 0 0 1 4 3.316v-.908z"})),e("retry"))}function _o(t){let{i18n:e,uppy:r}=t;return m("button",{type:"button",className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",title:e("cancel"),"aria-label":e("cancel"),onClick:()=>r.cancelAll(),"data-cy":"cancel","data-uppy-super-focusable":!0},m("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16"},m("g",{fill:"none",fillRule:"evenodd"},m("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),m("path",{fill:"#FFF",d:"M9.283 8l2.567 2.567-1.283 1.283L8 9.283 5.433 11.85 4.15 10.567 6.717 8 4.15 5.433 5.433 4.15 8 6.717l2.567-2.567 1.283 1.283z"}))))}function bo(t){let{isAllPaused:e,i18n:r,isAllComplete:s,resumableUploads:i,uppy:o}=t,n=r(e?"resume":"pause");function a(){if(!s){if(!i){o.cancelAll();return}if(e){o.resumeAll();return}o.pauseAll()}}return m("button",{title:n,"aria-label":n,className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",type:"button",onClick:a,"data-cy":"togglePauseResume","data-uppy-super-focusable":!0},m("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16"},m("g",{fill:"none",fillRule:"evenodd"},m("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),m("path",{fill:"#FFF",d:e?"M6 4.25L11.5 8 6 11.75z":"M5 4.5h2v7H5v-7zm4 0h2v7H9v-7z"}))))}function wo(t){let{i18n:e,doneButtonHandler:r}=t;return m("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--done",onClick:r,"data-uppy-super-focusable":!0},e("done"))}function So(){return m("svg",{className:"uppy-StatusBar-spinner","aria-hidden":"true",focusable:"false",width:"14",height:"14"},m("path",{d:"M13.983 6.547c-.12-2.509-1.64-4.893-3.939-5.936-2.48-1.127-5.488-.656-7.556 1.094C.524 3.367-.398 6.048.162 8.562c.556 2.495 2.46 4.52 4.94 5.183 2.932.784 5.61-.602 7.256-3.015-1.493 1.993-3.745 3.309-6.298 2.868-2.514-.434-4.578-2.349-5.153-4.84a6.226 6.226 0 0 1 2.98-6.778C6.34.586 9.74 1.1 11.373 3.493c.407.596.693 1.282.842 1.988.127.598.073 1.197.161 1.794.078.525.543 1.257 1.15.864.525-.341.49-1.05.456-1.592-.007-.15.02.3 0 0",fillRule:"evenodd"}))}function Po(t){let{progress:e}=t,{value:r,mode:s,message:i}=e;return m("div",{className:"uppy-StatusBar-content"},m(So,null),s==="determinate"?`${Math.round(r*100)}% \xB7 `:"",i)}function Qa(t){let{numUploads:e,complete:r,totalUploadedSize:s,totalSize:i,totalETA:o,i18n:n}=t,a=e>1;return m("div",{className:"uppy-StatusBar-statusSecondary"},a&&n("filesUploadedOfTotal",{complete:r,smart_count:e}),m("span",{className:"uppy-StatusBar-additionalInfo"},a&&go(),n("dataUploadedOfTotal",{complete:(0,ms.default)(s),total:(0,ms.default)(i)}),go(),n("xTimeLeft",{time:fs(o)})))}function To(t){let{i18n:e,complete:r,numUploads:s}=t;return m("div",{className:"uppy-StatusBar-statusSecondary"},e("filesUploadedOfTotal",{complete:r,smart_count:s}))}function Za(t){let{i18n:e,newFiles:r,startUpload:s}=t,i=(0,gs.default)("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--uploadNewlyAdded");return m("div",{className:"uppy-StatusBar-statusSecondary"},m("div",{className:"uppy-StatusBar-statusSecondaryHint"},e("xMoreFilesAdded",{smart_count:r})),m("button",{type:"button",className:i,"aria-label":e("uploadXFiles",{smart_count:r}),onClick:s},e("upload")))}function Fo(t){let{i18n:e,supportsUploadProgress:r,totalProgress:s,showProgressDetails:i,isUploadStarted:o,isAllComplete:n,isAllPaused:a,newFiles:l,numUploads:d,complete:p,totalUploadedSize:u,totalSize:h,totalETA:c,startUpload:f}=t,S=l&&o;if(!o||n)return null;let _=e(a?"paused":"uploading");function v(){return!a&&!S&&i?r?m(Qa,{numUploads:d,complete:p,totalUploadedSize:u,totalSize:h,totalETA:c,i18n:e}):m(To,{i18n:e,complete:p,numUploads:d}):null}return m("div",{className:"uppy-StatusBar-content","aria-label":_,title:_},a?null:m(So,null),m("div",{className:"uppy-StatusBar-status"},m("div",{className:"uppy-StatusBar-statusPrimary"},r?`${_}: ${s}%`:_),v(),S?m(Za,{i18n:e,newFiles:l,startUpload:f}):null))}function Eo(t){let{i18n:e}=t;return m("div",{className:"uppy-StatusBar-content",role:"status",title:e("complete")},m("div",{className:"uppy-StatusBar-status"},m("div",{className:"uppy-StatusBar-statusPrimary"},m("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"15",height:"11",viewBox:"0 0 15 11"},m("path",{d:"M.414 5.843L1.627 4.63l3.472 3.472L13.202 0l1.212 1.213L5.1 10.528z"})),e("complete"))))}function Uo(t){let{error:e,i18n:r,complete:s,numUploads:i}=t;function o(){let n=`${r("uploadFailed")} 

 ${e}`;alert(n)}return m("div",{className:"uppy-StatusBar-content",title:r("uploadFailed")},m("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"11",height:"11",viewBox:"0 0 11 11"},m("path",{d:"M4.278 5.5L0 1.222 1.222 0 5.5 4.278 9.778 0 11 1.222 6.722 5.5 11 9.778 9.778 11 5.5 6.722 1.222 11 0 9.778z"})),m("div",{className:"uppy-StatusBar-status"},m("div",{className:"uppy-StatusBar-statusPrimary"},r("uploadFailed"),m("button",{className:"uppy-u-reset uppy-StatusBar-details","aria-label":r("showErrorDetails"),"data-microtip-position":"top-right","data-microtip-size":"medium",onClick:o,type:"button"},"?")),m(To,{i18n:r,complete:s,numUploads:i})))}var{STATE_ERROR:Oo,STATE_WAITING:xo,STATE_PREPROCESSING:ys,STATE_UPLOADING:Tr,STATE_POSTPROCESSING:vs,STATE_COMPLETE:Fr}=se;function Er(t){let{newFiles:e,allowNewUpload:r,isUploadInProgress:s,isAllPaused:i,resumableUploads:o,error:n,hideUploadButton:a,hidePauseResumeButton:l,hideCancelButton:d,hideRetryButton:p,recoveredState:u,uploadState:h,totalProgress:c,files:f,supportsUploadProgress:S,hideAfterFinish:_,isSomeGhost:v,doneButtonHandler:F,isUploadStarted:x,i18n:A,startUpload:R,uppy:E,isAllComplete:P,showProgressDetails:U,numUploads:O,complete:Q,totalSize:$r,totalETA:jr,totalUploadedSize:ft}=t;function $e(){switch(h){case vs:case ys:{let sr=xt(f);return sr.mode==="determinate"?sr.value*100:c}case Oo:return null;case Tr:return S?c:null;default:return c}}function tr(){switch(h){case vs:case ys:{let{mode:sr}=xt(f);return sr==="indeterminate"}case Tr:return!S;default:return!1}}function rr(){if(u)return!1;switch(h){case xo:return a||e===0;case Fr:return _;default:return!1}}let je=$e(),lt=rr(),me=je??100,ut=!n&&e&&!s&&!i&&r&&!a,an=!d&&h!==xo&&h!==Fr,ln=o&&!l&&h===Tr,un=n&&!P&&!p,dn=F&&h===Fr,pn=(0,_s.default)("uppy-StatusBar-progress",{"is-indeterminate":tr()}),cn=(0,_s.default)("uppy-StatusBar",`is-${h}`,{"has-ghosts":v});return m("div",{className:cn,"aria-hidden":lt},m("div",{className:pn,style:{width:`${me}%`},role:"progressbar","aria-label":`${me}%`,"aria-valuetext":`${me}%`,"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":je}),(()=>{switch(h){case ys:case vs:return m(Po,{progress:xt(f)});case Fr:return m(Eo,{i18n:A});case Oo:return m(Uo,{error:n,i18n:A,numUploads:O,complete:Q});case Tr:return m(Fo,{i18n:A,supportsUploadProgress:S,totalProgress:c,showProgressDetails:U,isUploadStarted:x,isAllComplete:P,isAllPaused:i,newFiles:e,numUploads:O,complete:Q,totalUploadedSize:ft,totalSize:$r,totalETA:jr,startUpload:R});default:return null}})(),m("div",{className:"uppy-StatusBar-actions"},u||ut?m(yo,{newFiles:e,isUploadStarted:x,recoveredState:u,i18n:A,isSomeGhost:v,startUpload:R,uploadState:h}):null,un?m(vo,{i18n:A,uppy:E}):null,ln?m(bo,{isAllPaused:i,i18n:A,isAllComplete:P,resumableUploads:o,uppy:E}):null,an?m(_o,{i18n:A,uppy:E}):null,dn?m(wo,{i18n:A,doneButtonHandler:F}):null))}Er.defaultProps={doneButtonHandler:void 0,hideAfterFinish:!1,hideCancelButton:!1,hidePauseResumeButton:!1,hideRetryButton:!1,hideUploadButton:void 0,showProgressDetails:void 0};var Ao={strings:{uploading:"Uploading",complete:"Complete",uploadFailed:"Upload failed",paused:"Paused",retry:"Retry",cancel:"Cancel",pause:"Pause",resume:"Resume",done:"Done",filesUploadedOfTotal:{0:"%{complete} of %{smart_count} file uploaded",1:"%{complete} of %{smart_count} files uploaded"},dataUploadedOfTotal:"%{complete} of %{total}",xTimeLeft:"%{time} left",uploadXFiles:{0:"Upload %{smart_count} file",1:"Upload %{smart_count} files"},uploadXNewFiles:{0:"Upload +%{smart_count} file",1:"Upload +%{smart_count} files"},upload:"Upload",retryUpload:"Retry upload",xMoreFilesAdded:{0:"%{smart_count} more file added",1:"%{smart_count} more files added"},showErrorDetails:"Show error details"}};function k(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var el=0;function pt(t){return"__private_"+el+++"_"+t}var tl={version:"3.3.1"},rl=2e3,sl=2e3;function il(t,e,r,s){if(t)return se.STATE_ERROR;if(e)return se.STATE_COMPLETE;if(r)return se.STATE_WAITING;let i=se.STATE_WAITING,o=Object.keys(s);for(let n=0;n<o.length;n++){let{progress:a}=s[o[n]];if(a.uploadStarted&&!a.uploadComplete)return se.STATE_UPLOADING;a.preprocess&&(i=se.STATE_PREPROCESSING),a.postprocess&&i!==se.STATE_PREPROCESSING&&(i=se.STATE_POSTPROCESSING)}return i}var ol={target:"body",hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideCancelButton:!1,showProgressDetails:!1,hideAfterFinish:!0,doneButtonHandler:null},ue=pt("lastUpdateTime"),he=pt("previousUploadedBytes"),we=pt("previousSpeed"),ie=pt("previousETA"),bs=pt("computeSmoothETA"),At=pt("onUploadStart"),Re=class extends Ot{constructor(e,r){super(e,{...ol,...r}),Object.defineProperty(this,bs,{value:nl}),Object.defineProperty(this,ue,{writable:!0,value:void 0}),Object.defineProperty(this,he,{writable:!0,value:void 0}),Object.defineProperty(this,we,{writable:!0,value:void 0}),Object.defineProperty(this,ie,{writable:!0,value:void 0}),this.startUpload=()=>this.uppy.upload().catch(()=>{}),Object.defineProperty(this,At,{writable:!0,value:()=>{let{recoveredState:s}=this.uppy.getState();if(k(this,we)[we]=null,k(this,ie)[ie]=null,s){k(this,he)[he]=Object.values(s.files).reduce((i,o)=>{let{progress:n}=o;return i+n.bytesUploaded},0),this.uppy.emit("restore-confirmed");return}k(this,ue)[ue]=performance.now(),k(this,he)[he]=0}}),this.id=this.opts.id||"StatusBar",this.title="StatusBar",this.type="progressindicator",this.defaultLocale=Ao,this.i18nInit(),this.render=this.render.bind(this),this.install=this.install.bind(this)}render(e){let{capabilities:r,files:s,allowNewUpload:i,totalProgress:o,error:n,recoveredState:a}=e,{newFiles:l,startedFiles:d,completeFiles:p,isUploadStarted:u,isAllComplete:h,isAllErrored:c,isAllPaused:f,isUploadInProgress:S,isSomeGhost:_}=this.uppy.getObjectOfFilesPerState(),v=a?Object.values(s):l,F=!!r.resumableUploads,x=r.uploadProgress!==!1,A=0,R=0;d.forEach(P=>{A+=P.progress.bytesTotal||0,R+=P.progress.bytesUploaded||0});let E=k(this,bs)[bs]({uploaded:R,total:A,remaining:A-R});return Er({error:n,uploadState:il(n,h,a,e.files||{}),allowNewUpload:i,totalProgress:o,totalSize:A,totalUploadedSize:R,isAllComplete:!1,isAllPaused:f,isAllErrored:c,isUploadStarted:u,isUploadInProgress:S,isSomeGhost:_,recoveredState:a,complete:p.length,newFiles:v.length,numUploads:d.length,totalETA:E,files:s,i18n:this.i18n,uppy:this.uppy,startUpload:this.startUpload,doneButtonHandler:this.opts.doneButtonHandler,resumableUploads:F,supportsUploadProgress:x,showProgressDetails:this.opts.showProgressDetails,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,hideCancelButton:this.opts.hideCancelButton,hideAfterFinish:this.opts.hideAfterFinish,isTargetDOMEl:this.isTargetDOMEl})}onMount(){let e=this.el;_r(e)||(e.dir="ltr")}install(){let{target:e}=this.opts;e&&this.mount(e,this),this.uppy.on("upload",k(this,At)[At]),k(this,ue)[ue]=performance.now(),k(this,he)[he]=this.uppy.getFiles().reduce((r,s)=>r+s.progress.bytesUploaded,0)}uninstall(){this.unmount(),this.uppy.off("upload",k(this,At)[At])}};function nl(t){var e,r;if(t.total===0||t.remaining===0)return 0;(r=(e=k(this,ue))[ue])!=null||(e[ue]=performance.now());let s=performance.now()-k(this,ue)[ue];if(s===0){var i;return Math.round(((i=k(this,ie)[ie])!=null?i:0)/100)/10}let o=t.uploaded-k(this,he)[he];if(k(this,he)[he]=t.uploaded,o<=0){var n;return Math.round(((n=k(this,ie)[ie])!=null?n:0)/100)/10}let a=o/s,l=k(this,we)[we]==null?a:Sr(a,k(this,we)[we],rl,s);k(this,we)[we]=l;let d=t.remaining/l,p=Math.max(k(this,ie)[ie]-s,0),u=k(this,ie)[ie]==null?d:Sr(d,p,sl,s);return k(this,ie)[ie]=u,k(this,ue)[ue]=performance.now(),Math.round(u/100)/10}Re.VERSION=tl.version;var ws=class extends Error{constructor(){super(...arguments),this.name="UserFacingApiError"}},Co=ws;var Bo=ge(No(),1);var ll=Object.prototype.toString,ul=t=>ll.call(t)==="[object Error]",dl=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Load failed","Network request failed","fetch failed","terminated"]);function Ss(t){return t&&ul(t)&&t.name==="TypeError"&&typeof t.message=="string"?t.message==="Load failed"?t.stack===void 0:dl.has(t.message):!1}var ct=class extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}},Mo=(t,e,r)=>{let s=r.retries-(e-1);return t.attemptNumber=e,t.retriesLeft=s,t};async function Ur(t,e){return new Promise((r,s)=>{e={onFailedAttempt(){},retries:10,shouldRetry:()=>!0,...e};let i=Bo.default.operation(e),o=()=>{i.stop(),s(e.signal?.reason)};e.signal&&!e.signal.aborted&&e.signal.addEventListener("abort",o,{once:!0});let n=()=>{e.signal?.removeEventListener("abort",o),i.stop()};i.attempt(async a=>{try{let l=await t(a);n(),r(l)}catch(l){try{if(!(l instanceof Error))throw new TypeError(`Non-error was thrown: "${l}". You should only throw errors.`);if(l instanceof ct)throw l.originalError;if(l instanceof TypeError&&!Ss(l))throw l;if(Mo(l,a,e),await e.shouldRetry(l)||(i.stop(),s(l)),await e.onFailedAttempt(l),!i.retry(l))throw i.mainError()}catch(d){Mo(d,a,e),n(),s(d)}}})})}var Ps=class extends Error{constructor(e,r){r===void 0&&(r=null),super("This looks like a network error, the endpoint might be blocked by an internet provider or a firewall."),this.cause=e,this.isNetworkError=!0,this.request=r}},Lo=Ps;function Ts(){return fetch(...arguments).catch(t=>{throw t.name==="AbortError"?t:new Lo(t)})}function Ct(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Fs=class extends Error{constructor(e,r){super(e),this.cause=r?.cause,this.cause&&Ct(this.cause,"isNetworkError")?this.isNetworkError=this.cause.isNetworkError:this.isNetworkError=!1}},Io=Fs;var Do=ge(Ir(),1);function pl(t,e,r){let{progress:s,bytesUploaded:i,bytesTotal:o}=e;s&&(t.uppy.log(`Upload progress: ${s}`),t.uppy.emit("upload-progress",r,{uploader:t,bytesUploaded:i,bytesTotal:o}))}var qo=(0,Do.default)(pl,300,{leading:!0,trailing:!0});function Es(t){var e;let s=(e=/^(?:https?:\/\/|\/\/)?(?:[^@\n]+@)?(?:www\.)?([^\n]+)/i.exec(t))==null?void 0:e[1];return`${/^http:\/\//i.test(t)?"ws":"wss"}://${s}`}var Us=class extends Error{constructor(){super("Authorization required"),this.name="AuthError",this.isAuthError=!0}},zo=Us;var Ho;function Se(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var cl=0;function Or(t){return"__private_"+cl+++"_"+t}var hl={version:"3.8.0"};function fl(t){return t.replace(/\/$/,"")}var Go=10,ml=5*60*1e3,Ko=401,xs=class extends Error{constructor(e){let{statusCode:r,message:s}=e;super(s),this.name="HttpError",this.statusCode=r}};async function gl(t){if(t.status===Ko)throw new zo;if(t.ok)return t.json();let e=`Failed request with status: ${t.status}. ${t.statusText}`,r;try{r=await t.json(),r.message&&(e=`${e} message: ${r.message}`),r.requestId&&(e=`${e} request-Id: ${r.requestId}`)}catch(s){throw new Error(e,{cause:s})}throw t.status>=400&&t.status<=499&&r.message?new Co(r.message):new xs({statusCode:t.status,message:e})}var Pe=Or("companionHeaders"),kt=Or("getUrl"),Os=Or("requestSocketToken"),Rt=Or("awaitRemoteFileUpload");Ho=Symbol.for("uppy test: getCompanionHeaders");var Te=class{constructor(e,r){Object.defineProperty(this,Rt,{value:vl}),Object.defineProperty(this,kt,{value:yl}),Object.defineProperty(this,Pe,{writable:!0,value:void 0}),Object.defineProperty(this,Os,{writable:!0,value:async s=>{var i;let{file:o,postBody:n,signal:a}=s;if(((i=o.remote)==null?void 0:i.url)==null)throw new Error("Cannot connect to an undefined URL");return(await this.post(o.remote.url,{...o.remote.body,...n},{signal:a})).token}}),this.uppy=e,this.opts=r,this.onReceiveResponse=this.onReceiveResponse.bind(this),Se(this,Pe)[Pe]=r?.companionHeaders}setCompanionHeaders(e){Se(this,Pe)[Pe]=e}[Ho](){return Se(this,Pe)[Pe]}get hostname(){let{companion:e}=this.uppy.getState(),r=this.opts.companionUrl;return fl(e&&e[r]?e[r]:r)}async headers(e){return e===void 0&&(e=!1),{...{Accept:"application/json",...e?void 0:{"Content-Type":"application/json"}},...Se(this,Pe)[Pe]}}onReceiveResponse(e){let{headers:r}=e,i=this.uppy.getState().companion||{},o=this.opts.companionUrl;r.has("i-am")&&r.get("i-am")!==i[o]&&this.uppy.setState({companion:{...i,[o]:r.get("i-am")}})}async request(e){let{path:r,method:s="GET",data:i,skipPostResponse:o,signal:n}=e;try{let a=await this.headers(!i),l=await Ts(Se(this,kt)[kt](r),{method:s,signal:n,headers:a,credentials:this.opts.companionCookiesRule||"same-origin",body:i?JSON.stringify(i):null});return o||this.onReceiveResponse(l),await gl(l)}catch(a){throw a.isAuthError||a.name==="UserFacingApiError"||a.name==="AbortError"?a:new Io(`Could not ${s} ${Se(this,kt)[kt](r)}`,{cause:a})}}async get(e,r){return typeof r=="boolean"&&(r={skipPostResponse:r}),this.request({...r,path:e})}async post(e,r,s){return typeof s=="boolean"&&(s={skipPostResponse:s}),this.request({...s,path:e,method:"POST",data:r})}async delete(e,r,s){return typeof s=="boolean"&&(s={skipPostResponse:s}),this.request({...s,path:e,method:"DELETE",data:r})}async uploadRemoteFile(e,r,s){var i=this;try{let{signal:o,getQueue:n}=s||{};return await Ur(async()=>{var a;let l=(a=this.uppy.getFile(e.id))==null?void 0:a.serverToken;if(l!=null)return this.uppy.log(`Connecting to exiting websocket ${l}`),Se(this,Rt)[Rt]({file:e,queue:n(),signal:o});let p=await n().wrapPromiseFunction(async function(){try{return await Se(i,Os)[Os](...arguments)}catch(u){if(u.isAuthError)throw new ct(u);if(u.cause==null)throw u;let h=u.cause,c=()=>[408,409,429,418,423].includes(h.statusCode)||h.statusCode>=500&&h.statusCode<=599&&![501,505].includes(h.statusCode);throw h.name==="HttpError"&&!c()?new ct(h):h}},{priority:-1})({file:e,postBody:r,signal:o}).abortOn(o);if(this.uppy.getFile(e.id))return this.uppy.setFileState(e.id,{serverToken:p}),Se(this,Rt)[Rt]({file:this.uppy.getFile(e.id),queue:n(),signal:o})},{retries:Go,signal:o,onFailedAttempt:a=>this.uppy.log(`Retrying upload due to: ${a.message}`,"warning")})}catch(o){if(o.name==="AbortError")return;throw this.uppy.emit("upload-error",e,o),o}}};function yl(t){return/^(https?:|)\/\//.test(t)?t:`${this.hostname}/${t}`}async function vl(t){let{file:e,queue:r,signal:s}=t,i,{capabilities:o}=this.uppy.getState();try{return await new Promise((n,a)=>{let l=e.serverToken,d=Es(e.remote.companionUrl),p,u,h,{isPaused:c}=e,f=(P,U)=>{if(p==null||p.readyState!==p.OPEN){var O;this.uppy.log(`Cannot send "${P}" to socket ${e.id} because the socket state was ${String((O=p)==null?void 0:O.readyState)}`,"warning");return}p.send(JSON.stringify({action:P,payload:U??{}}))};function S(){o.resumableUploads&&f(c?"pause":"resume")}let _=async()=>{u&&u.abort(),u=new AbortController;let P=O=>{var Q;this.uppy.setFileState(e.id,{serverToken:null}),(Q=u)==null||Q.abort==null||Q.abort(),a(O)};function U(){clearTimeout(h),!c&&(h=setTimeout(()=>P(new Error("Timeout waiting for message from Companion socket")),ml))}try{await r.wrapPromiseFunction(async()=>{await Ur(async()=>new Promise((Q,$r)=>{p=new WebSocket(`${d}/api/${l}`),U(),p.addEventListener("close",()=>{p=void 0,$r(new Error("Socket closed unexpectedly"))}),p.addEventListener("error",ft=>{var $e;this.uppy.log(`Companion socket error ${JSON.stringify(ft)}, closing socket`,"warning"),($e=p)==null||$e.close()}),p.addEventListener("open",()=>{S()}),p.addEventListener("message",ft=>{U();try{let{action:lt,payload:me}=JSON.parse(ft.data);switch(lt){case"progress":{qo(this,me,this.uppy.getFile(e.id));break}case"success":{var $e,tr,rr,je;let ut=($e=me.response)==null?void 0:$e.responseText;this.uppy.emit("upload-success",this.uppy.getFile(e.id),{uploadURL:me.url,status:(tr=(rr=me.response)==null?void 0:rr.status)!=null?tr:200,body:ut?JSON.parse(ut):void 0}),(je=u)==null||je.abort==null||je.abort(),n();break}case"error":{let{message:ut}=me.error;throw Object.assign(new Error(ut),{cause:me.error})}default:this.uppy.log(`Companion socket unknown action ${lt}`,"warning")}}catch(lt){P(lt)}});let jr=()=>{this.uppy.log(`Closing socket ${e.id}`,"info"),clearTimeout(h),p&&p.close(),p=void 0};u.signal.addEventListener("abort",()=>{jr()})}),{retries:Go,signal:u.signal,onFailedAttempt:()=>{u.signal.aborted||this.uppy.log(`Retrying websocket ${e.id}`,"info")}})})().abortOn(u.signal)}catch(O){if(u.signal.aborted)return;P(O)}},v=P=>{if(o.resumableUploads)if(c=P,p&&S(),P){var U;(U=u)==null||U.abort==null||U.abort()}else _()},F=P=>{var U;o.individualCancellation&&P.id===e.id&&(f("cancel"),(U=u)==null||U.abort==null||U.abort(),this.uppy.log(`upload ${e.id} was removed`,"info"),n())},x=P=>{var U;let{reason:O}=P;O==="user"&&f("cancel"),(U=u)==null||U.abort==null||U.abort(),this.uppy.log(`upload ${e.id} was canceled`,"info"),n()},A=(P,U)=>{P===e.id&&v(U)},R=()=>v(!0),E=()=>v(!1);this.uppy.on("file-removed",F),this.uppy.on("cancel-all",x),this.uppy.on("upload-pause",A),this.uppy.on("pause-all",R),this.uppy.on("resume-all",E),i=()=>{this.uppy.off("file-removed",F),this.uppy.off("cancel-all",x),this.uppy.off("upload-pause",A),this.uppy.off("pause-all",R),this.uppy.off("resume-all",E)},s.addEventListener("abort",()=>{var P;(P=u)==null||P.abort()}),_()})}finally{i?.()}}Te.VERSION=hl.version;var Jo=ge(Nr(),1),Wo,Xo;function j(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var bl=0;function $t(t){return"__private_"+bl+++"_"+t}var Fe=$t("queued"),Ge=$t("emitter"),fe=$t("isOpen"),B=$t("socket"),As=$t("handleMessage");Wo=Symbol.for("uppy test: getSocket");Xo=Symbol.for("uppy test: getQueued");var xr=class{constructor(e){Object.defineProperty(this,Fe,{writable:!0,value:[]}),Object.defineProperty(this,Ge,{writable:!0,value:(0,Jo.default)()}),Object.defineProperty(this,fe,{writable:!0,value:!1}),Object.defineProperty(this,B,{writable:!0,value:void 0}),Object.defineProperty(this,As,{writable:!0,value:r=>{try{let s=JSON.parse(r.data);this.emit(s.action,s.payload)}catch(s){console.log(s)}}}),this.opts=e,(!e||e.autoOpen!==!1)&&this.open()}get isOpen(){return j(this,fe)[fe]}[Wo](){return j(this,B)[B]}[Xo](){return j(this,Fe)[Fe]}open(){j(this,B)[B]==null&&(j(this,B)[B]=new WebSocket(this.opts.target),j(this,B)[B].onopen=()=>{for(j(this,fe)[fe]=!0;j(this,Fe)[Fe].length>0&&j(this,fe)[fe];){let e=j(this,Fe)[Fe].shift();this.send(e.action,e.payload)}},j(this,B)[B].onclose=()=>{j(this,fe)[fe]=!1,j(this,B)[B]=null},j(this,B)[B].onmessage=j(this,As)[As])}close(){var e;(e=j(this,B)[B])==null||e.close()}send(e,r){if(!j(this,fe)[fe]){j(this,Fe)[Fe].push({action:e,payload:r});return}j(this,B)[B].send(JSON.stringify({action:e,payload:r}))}on(e,r){j(this,Ge)[Ge].on(e,r)}emit(e,r){j(this,Ge)[Ge].emit(e,r)}once(e,r){j(this,Ge)[Ge].once(e,r)}};function Ee(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var wl=0;function Vo(t){return"__private_"+wl+++"_"+t}var W=Vo("uppy"),jt=Vo("events"),Nt=class{constructor(e){Object.defineProperty(this,W,{writable:!0,value:void 0}),Object.defineProperty(this,jt,{writable:!0,value:[]}),Ee(this,W)[W]=e}on(e,r){return Ee(this,jt)[jt].push([e,r]),Ee(this,W)[W].on(e,r)}remove(){for(let[e,r]of Ee(this,jt)[jt].splice(0))Ee(this,W)[W].off(e,r)}onFilePause(e,r){this.on("upload-pause",(s,i)=>{e===s&&r(i)})}onFileRemove(e,r){this.on("file-removed",s=>{e===s.id&&r(s.id)})}onPause(e,r){this.on("upload-pause",(s,i)=>{e===s&&r(i)})}onRetry(e,r){this.on("upload-retry",s=>{e===s&&r()})}onRetryAll(e,r){this.on("retry-all",()=>{Ee(this,W)[W].getFile(e)&&r()})}onPauseAll(e,r){this.on("pause-all",()=>{Ee(this,W)[W].getFile(e)&&r()})}onCancelAll(e,r){var s=this;this.on("cancel-all",function(){Ee(s,W)[W].getFile(e)&&r(...arguments)})}onResumeAll(e,r){this.on("resume-all",()=>{Ee(this,W)[W].getFile(e)&&r()})}};function b(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var Sl=0;function ee(t){return"__private_"+Sl+++"_"+t}function Pl(t){return new Error("Cancelled",{cause:t})}function Yo(t){if(t!=null){var e;let r=()=>this.abort(t.reason);t.addEventListener("abort",r,{once:!0});let s=()=>{t.removeEventListener("abort",r)};(e=this.then)==null||e.call(this,s,s)}return this}var ne=ee("activeRequests"),J=ee("queuedHandlers"),oe=ee("paused"),Ke=ee("pauseTimer"),X=ee("downLimit"),We=ee("upperLimit"),Ue=ee("rateLimitingTimer"),Mt=ee("call"),Oe=ee("queueNext"),Rs=ee("next"),Cs=ee("queue"),$s=ee("dequeue"),ks=ee("resume"),Xe=ee("increaseLimit"),Ar=class{constructor(e){Object.defineProperty(this,$s,{value:Ol}),Object.defineProperty(this,Cs,{value:Ul}),Object.defineProperty(this,Rs,{value:El}),Object.defineProperty(this,Oe,{value:Fl}),Object.defineProperty(this,Mt,{value:Tl}),Object.defineProperty(this,ne,{writable:!0,value:0}),Object.defineProperty(this,J,{writable:!0,value:[]}),Object.defineProperty(this,oe,{writable:!0,value:!1}),Object.defineProperty(this,Ke,{writable:!0,value:void 0}),Object.defineProperty(this,X,{writable:!0,value:1}),Object.defineProperty(this,We,{writable:!0,value:void 0}),Object.defineProperty(this,Ue,{writable:!0,value:void 0}),Object.defineProperty(this,ks,{writable:!0,value:()=>this.resume()}),Object.defineProperty(this,Xe,{writable:!0,value:()=>{if(b(this,oe)[oe]){b(this,Ue)[Ue]=setTimeout(b(this,Xe)[Xe],0);return}b(this,X)[X]=this.limit,this.limit=Math.ceil((b(this,We)[We]+b(this,X)[X])/2);for(let r=b(this,X)[X];r<=this.limit;r++)b(this,Oe)[Oe]();b(this,We)[We]-b(this,X)[X]>3?b(this,Ue)[Ue]=setTimeout(b(this,Xe)[Xe],2e3):b(this,X)[X]=Math.floor(b(this,X)[X]/2)}}),typeof e!="number"||e===0?this.limit=1/0:this.limit=e}run(e,r){return!b(this,oe)[oe]&&b(this,ne)[ne]<this.limit?b(this,Mt)[Mt](e):b(this,Cs)[Cs](e,r)}wrapSyncFunction(e,r){var s=this;return function(){for(var i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];let a=s.run(()=>(e(...o),queueMicrotask(()=>a.done()),()=>{}),r);return{abortOn:Yo,abort(){a.abort()}}}}wrapPromiseFunction(e,r){var s=this;return function(){for(var i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];let a,l=new Promise((d,p)=>{a=s.run(()=>{let u,h;try{h=Promise.resolve(e(...o))}catch(c){h=Promise.reject(c)}return h.then(c=>{u?p(u):(a.done(),d(c))},c=>{u?p(u):(a.done(),p(c))}),c=>{u=Pl(c)}},r)});return l.abort=d=>{a.abort(d)},l.abortOn=Yo,l}}resume(){b(this,oe)[oe]=!1,clearTimeout(b(this,Ke)[Ke]);for(let e=0;e<this.limit;e++)b(this,Oe)[Oe]()}pause(e){e===void 0&&(e=null),b(this,oe)[oe]=!0,clearTimeout(b(this,Ke)[Ke]),e!=null&&(b(this,Ke)[Ke]=setTimeout(b(this,ks)[ks],e))}rateLimit(e){clearTimeout(b(this,Ue)[Ue]),this.pause(e),this.limit>1&&Number.isFinite(this.limit)&&(b(this,We)[We]=this.limit-1,this.limit=b(this,X)[X],b(this,Ue)[Ue]=setTimeout(b(this,Xe)[Xe],e))}get isPaused(){return b(this,oe)[oe]}};function Tl(t){b(this,ne)[ne]+=1;let e=!1,r;try{r=t()}catch(s){throw b(this,ne)[ne]-=1,s}return{abort:s=>{e||(e=!0,b(this,ne)[ne]-=1,r?.(s),b(this,Oe)[Oe]())},done:()=>{e||(e=!0,b(this,ne)[ne]-=1,b(this,Oe)[Oe]())}}}function Fl(){queueMicrotask(()=>b(this,Rs)[Rs]())}function El(){if(b(this,oe)[oe]||b(this,ne)[ne]>=this.limit||b(this,J)[J].length===0)return;let t=b(this,J)[J].shift();if(t==null)throw new Error("Invariant violation: next is null");let e=b(this,Mt)[Mt](t.fn);t.abort=e.abort,t.done=e.done}function Ul(t,e){let r={fn:t,priority:e?.priority||0,abort:()=>{b(this,$s)[$s](r)},done:()=>{throw new Error("Cannot mark a queued request as done: this indicates a bug")}},s=b(this,J)[J].findIndex(i=>r.priority>i.priority);return s===-1?b(this,J)[J].push(r):b(this,J)[J].splice(s,0,r),r}function Ol(t){let e=b(this,J)[J].indexOf(t);e!==-1&&b(this,J)[J].splice(e,1)}var Mp=Symbol("__queue");function Qo(t){let e=r=>"error"in r&&!!r.error;return t.filter(r=>!e(r))}function Zo(t){return t.filter(e=>{var r;return!((r=e.progress)!=null&&r.uploadStarted)||!e.isRestored})}var{AbortController:Cr}=globalThis,{AbortSignal:Dp}=globalThis,kr=function(t,e){t===void 0&&(t="Aborted");let r=new DOMException(t,"AbortError");return e!=null&&Ct(e,"cause")&&Object.defineProperty(r,"cause",{__proto__:null,configurable:!0,writable:!0,value:e.cause}),r};function y(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var xl=0;function I(t){return"__private_"+xl+++"_"+t}var Al=1024*1024,en={getChunkSize(t){return Math.ceil(t.size/1e4)},onProgress(){},onPartComplete(){},onSuccess(){},onError(t){throw t}};function Cl(t){if(typeof t=="string")return parseInt(t,10);if(typeof t=="number")return t;throw new TypeError("Expected a number")}var zt=Symbol("pausing upload, not an actual error"),z=I("abortController"),L=I("chunks"),V=I("chunkState"),ae=I("data"),le=I("file"),Ht=I("uploadHasStarted"),Bt=I("onError"),Ye=I("onSuccess"),xe=I("shouldUseMultipart"),Ve=I("isRestoring"),Gt=I("onReject"),Je=I("maxMultipartParts"),It=I("minPartSize"),js=I("initChunks"),Ns=I("createUpload"),Lt=I("resumeUpload"),Dt=I("onPartProgress"),qt=I("onPartComplete"),Ms=I("abortUpload"),Bs=class{constructor(e,r){var s,i;Object.defineProperty(this,Ms,{value:jl}),Object.defineProperty(this,Lt,{value:$l}),Object.defineProperty(this,Ns,{value:Rl}),Object.defineProperty(this,js,{value:kl}),Object.defineProperty(this,z,{writable:!0,value:new Cr}),Object.defineProperty(this,L,{writable:!0,value:void 0}),Object.defineProperty(this,V,{writable:!0,value:void 0}),Object.defineProperty(this,ae,{writable:!0,value:void 0}),Object.defineProperty(this,le,{writable:!0,value:void 0}),Object.defineProperty(this,Ht,{writable:!0,value:!1}),Object.defineProperty(this,Bt,{writable:!0,value:void 0}),Object.defineProperty(this,Ye,{writable:!0,value:void 0}),Object.defineProperty(this,xe,{writable:!0,value:void 0}),Object.defineProperty(this,Ve,{writable:!0,value:void 0}),Object.defineProperty(this,Gt,{writable:!0,value:o=>o?.cause===zt?null:y(this,Bt)[Bt](o)}),Object.defineProperty(this,Je,{writable:!0,value:1e4}),Object.defineProperty(this,It,{writable:!0,value:5*Al}),Object.defineProperty(this,Dt,{writable:!0,value:o=>n=>{if(!n.lengthComputable)return;y(this,V)[V][o].uploaded=Cl(n.loaded);let a=y(this,V)[V].reduce((l,d)=>l+d.uploaded,0);this.options.onProgress(a,y(this,ae)[ae].size)}}),Object.defineProperty(this,qt,{writable:!0,value:o=>n=>{y(this,L)[L][o]=null,y(this,V)[V][o].etag=n,y(this,V)[V][o].done=!0;let a={PartNumber:o+1,ETag:n};this.options.onPartComplete(a)}}),this.options={...en,...r},(i=(s=this.options).getChunkSize)!=null||(s.getChunkSize=en.getChunkSize),y(this,ae)[ae]=e,y(this,le)[le]=r.file,y(this,Ye)[Ye]=this.options.onSuccess,y(this,Bt)[Bt]=this.options.onError,y(this,xe)[xe]=this.options.shouldUseMultipart,y(this,Ve)[Ve]=r.uploadId&&r.key,y(this,js)[js]()}start(){y(this,Ht)[Ht]?(y(this,z)[z].signal.aborted||y(this,z)[z].abort(zt),y(this,z)[z]=new Cr,y(this,Lt)[Lt]()):y(this,Ve)[Ve]?(this.options.companionComm.restoreUploadFile(y(this,le)[le],{uploadId:this.options.uploadId,key:this.options.key}),y(this,Lt)[Lt]()):y(this,Ns)[Ns]()}pause(){y(this,z)[z].abort(zt),y(this,z)[z]=new Cr}abort(e){e!=null&&e.really?y(this,Ms)[Ms]():this.pause()}get chunkState(){return y(this,V)[V]}};function kl(){let t=y(this,ae)[ae].size,e=typeof y(this,xe)[xe]=="function"?y(this,xe)[xe](y(this,le)[le]):!!y(this,xe)[xe];if(e&&t>y(this,It)[It]){let r=Math.max(this.options.getChunkSize(y(this,ae)[ae]),y(this,It)[It]),s=Math.floor(t/r);s>y(this,Je)[Je]&&(s=y(this,Je)[Je],r=t/y(this,Je)[Je]),y(this,L)[L]=Array(s);for(let i=0,o=0;i<t;i+=r,o++){let n=Math.min(t,i+r),a=()=>{let l=i;return y(this,ae)[ae].slice(l,n)};if(y(this,L)[L][o]={getData:a,onProgress:y(this,Dt)[Dt](o),onComplete:y(this,qt)[qt](o),shouldUseMultipart:e},y(this,Ve)[Ve]){let l=i+r>t?t-i:r;y(this,L)[L][o].setAsUploaded=()=>{y(this,L)[L][o]=null,y(this,V)[V][o].uploaded=l}}}}else y(this,L)[L]=[{getData:()=>y(this,ae)[ae],onProgress:y(this,Dt)[Dt](0),onComplete:y(this,qt)[qt](0),shouldUseMultipart:e}];y(this,V)[V]=y(this,L)[L].map(()=>({uploaded:0}))}function Rl(){this.options.companionComm.uploadFile(y(this,le)[le],y(this,L)[L],y(this,z)[z].signal).then(y(this,Ye)[Ye],y(this,Gt)[Gt]),y(this,Ht)[Ht]=!0}function $l(){this.options.companionComm.resumeUploadFile(y(this,le)[le],y(this,L)[L],y(this,z)[z].signal).then(y(this,Ye)[Ye],y(this,Gt)[Gt])}function jl(){y(this,z)[z].abort(),this.options.companionComm.abortFileUpload(y(this,le)[le]).catch(t=>this.options.log(t))}var tn=Bs;function D(t){if(t!=null&&t.aborted)throw kr("The operation was aborted",{cause:t.reason})}function Nl(t){let{method:e="PUT",CanonicalUri:r="/",CanonicalQueryString:s="",SignedHeaders:i,HashedPayload:o}=t,n=Object.keys(i).map(a=>a.toLowerCase()).sort();return[e,r,s,...n.map(a=>`${a}:${i[a]}`),"",n.join(";"),o].join(`
`)}var Ls=new TextEncoder,Is={name:"HMAC",hash:"SHA-256"};async function Ml(t){let{subtle:e}=globalThis.crypto;return e.digest(Is.hash,Ls.encode(t))}async function Bl(t){let{subtle:e}=globalThis.crypto;return e.importKey("raw",typeof t=="string"?Ls.encode(t):t,Is,!1,["sign"])}function rn(t){let e=new Uint8Array(t),r="";for(let s=0;s<e.length;s++)r+=e[s].toString(16).padStart(2,"0");return r}async function Kt(t,e){let{subtle:r}=globalThis.crypto;return r.sign(Is,await Bl(t),Ls.encode(e))}async function Ds(t){let{accountKey:e,accountSecret:r,sessionToken:s,bucketName:i,Key:o,Region:n,expires:a,uploadId:l,partNumber:d}=t,p="s3",u=`${i}.${p}.${n}.amazonaws.com`,h=`/${encodeURI(o).replace(/[;?:@&=+$,#!'()*]/g,Q=>`%${Q.charCodeAt(0).toString(16).toUpperCase()}`)}`,c="UNSIGNED-PAYLOAD",f=new Date().toISOString().replace(/[-:]|\.\d+/g,""),S=f.slice(0,8),_=`${S}/${n}/${p}/aws4_request`,v=new URL(`https://${u}${h}`);v.searchParams.set("X-Amz-Algorithm","AWS4-HMAC-SHA256"),v.searchParams.set("X-Amz-Content-Sha256",c),v.searchParams.set("X-Amz-Credential",`${e}/${_}`),v.searchParams.set("X-Amz-Date",f),v.searchParams.set("X-Amz-Expires",a),v.searchParams.set("X-Amz-Security-Token",s),v.searchParams.set("X-Amz-SignedHeaders","host"),d&&v.searchParams.set("partNumber",d),l&&v.searchParams.set("uploadId",l),v.searchParams.set("x-id",d&&l?"UploadPart":"PutObject");let F=Nl({CanonicalUri:h,CanonicalQueryString:v.search.slice(1),SignedHeaders:{host:u},HashedPayload:c}),x=rn(await Ml(F)),A=["AWS4-HMAC-SHA256",f,_,x].join(`
`),R=await Kt(`AWS4${r}`,S),E=await Kt(R,n),P=await Kt(E,p),U=await Kt(P,"aws4_request"),O=rn(await Kt(U,A));return v.searchParams.set("X-Amz-Signature",O),v}function w(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var Ll=0;function Y(t){return"__private_"+Ll+++"_"+t}function Il(t){let e=new URL(t);return e.search="",e.hash="",e.href}var Wt=Y("abortMultipartUpload"),H=Y("cache"),Xt=Y("createMultipartUpload"),Jt=Y("fetchSignature"),Qt=Y("getUploadParameters"),Vt=Y("listParts"),tt=Y("previousRetryDelay"),rt=Y("requests"),Qe=Y("retryDelays"),Ze=Y("sendCompletionRequest"),et=Y("setS3MultipartState"),st=Y("uploadPartBytes"),G=Y("getFile"),qs=Y("shouldRetry"),Yt=Y("nonMultipartUpload"),Rr=class{constructor(e,r,s,i){Object.defineProperty(this,Yt,{value:ql}),Object.defineProperty(this,qs,{value:Dl}),Object.defineProperty(this,Wt,{writable:!0,value:void 0}),Object.defineProperty(this,H,{writable:!0,value:new WeakMap}),Object.defineProperty(this,Xt,{writable:!0,value:void 0}),Object.defineProperty(this,Jt,{writable:!0,value:void 0}),Object.defineProperty(this,Qt,{writable:!0,value:void 0}),Object.defineProperty(this,Vt,{writable:!0,value:void 0}),Object.defineProperty(this,tt,{writable:!0,value:void 0}),Object.defineProperty(this,rt,{writable:!0,value:void 0}),Object.defineProperty(this,Qe,{writable:!0,value:void 0}),Object.defineProperty(this,Ze,{writable:!0,value:void 0}),Object.defineProperty(this,et,{writable:!0,value:void 0}),Object.defineProperty(this,st,{writable:!0,value:void 0}),Object.defineProperty(this,G,{writable:!0,value:void 0}),w(this,rt)[rt]=e,w(this,et)[et]=s,w(this,G)[G]=i,this.setOptions(r)}setOptions(e){let r=w(this,rt)[rt];if("abortMultipartUpload"in e&&(w(this,Wt)[Wt]=r.wrapPromiseFunction(e.abortMultipartUpload,{priority:1})),"createMultipartUpload"in e&&(w(this,Xt)[Xt]=r.wrapPromiseFunction(e.createMultipartUpload,{priority:-1})),"signPart"in e&&(w(this,Jt)[Jt]=r.wrapPromiseFunction(e.signPart)),"listParts"in e&&(w(this,Vt)[Vt]=r.wrapPromiseFunction(e.listParts)),"completeMultipartUpload"in e&&(w(this,Ze)[Ze]=r.wrapPromiseFunction(e.completeMultipartUpload,{priority:1})),"retryDelays"in e){var s;w(this,Qe)[Qe]=(s=e.retryDelays)!=null?s:[]}"uploadPartBytes"in e&&(w(this,st)[st]=r.wrapPromiseFunction(e.uploadPartBytes,{priority:1/0})),"getUploadParameters"in e&&(w(this,Qt)[Qt]=r.wrapPromiseFunction(e.getUploadParameters))}async getUploadId(e,r){let s;for(;(s=w(this,H)[H].get(e.data))!=null;)try{return await s}catch{}let i=w(this,Xt)[Xt](w(this,G)[G](e),r),o=()=>{i.abort(r.reason),w(this,H)[H].delete(e.data)};return r.addEventListener("abort",o,{once:!0}),w(this,H)[H].set(e.data,i),i.then(async n=>{r.removeEventListener("abort",o),w(this,et)[et](e,n),w(this,H)[H].set(e.data,n)},()=>{r.removeEventListener("abort",o),w(this,H)[H].delete(e.data)}),i}async abortFileUpload(e){let r=w(this,H)[H].get(e.data);if(r==null)return;w(this,H)[H].delete(e.data),w(this,et)[et](e,Object.create(null));let s;try{s=await r}catch{return}await w(this,Wt)[Wt](w(this,G)[G](e),s)}async uploadFile(e,r,s){if(D(s),r.length===1&&!r[0].shouldUseMultipart)return w(this,Yt)[Yt](e,r[0],s);let{uploadId:i,key:o}=await this.getUploadId(e,s);D(s);try{let n=await Promise.all(r.map((a,l)=>this.uploadChunk(e,l+1,a,s)));return D(s),await w(this,Ze)[Ze](w(this,G)[G](e),{key:o,uploadId:i,parts:n,signal:s},s).abortOn(s)}catch(n){throw n?.cause!==zt&&n?.name!=="AbortError"&&this.abortFileUpload(e),n}}restoreUploadFile(e,r){w(this,H)[H].set(e.data,r)}async resumeUploadFile(e,r,s){if(D(s),r.length===1&&r[0]!=null&&!r[0].shouldUseMultipart)return w(this,Yt)[Yt](e,r[0],s);let{uploadId:i,key:o}=await this.getUploadId(e,s);D(s);let n=await w(this,Vt)[Vt](w(this,G)[G](e),{uploadId:i,key:o,signal:s},s).abortOn(s);D(s);let a=await Promise.all(r.map((l,d)=>{let p=d+1,u=n.find(h=>{let{PartNumber:c}=h;return c===p});return u==null?this.uploadChunk(e,p,l,s):(l==null||l.setAsUploaded==null||l.setAsUploaded(),{PartNumber:p,ETag:u.ETag})}));return D(s),w(this,Ze)[Ze](w(this,G)[G](e),{key:o,uploadId:i,parts:a,signal:s},s).abortOn(s)}async uploadChunk(e,r,s,i){D(i);let{uploadId:o,key:n}=await this.getUploadId(e,i),a=w(this,Qe)[Qe].values(),l=w(this,Qe)[Qe].values(),d=()=>{let p=a.next();return p==null||p.done?null:p.value};for(;;){D(i);let p=s.getData(),{onProgress:u,onComplete:h}=s,c;try{c=await w(this,Jt)[Jt](w(this,G)[G](e),{uploadId:o,key:n,partNumber:r,body:p,signal:i}).abortOn(i)}catch(f){let S=d();if(S==null||i.aborted)throw f;await new Promise(_=>setTimeout(_,S));continue}D(i);try{return{PartNumber:r,...await w(this,st)[st]({signature:c,body:p,size:p.size,onProgress:u,onComplete:h,signal:i}).abortOn(i)}}catch(f){if(!await w(this,qs)[qs](f,l))throw f}}}};async function Dl(t,e){var r;let s=w(this,rt)[rt],i=t==null||(r=t.source)==null?void 0:r.status;if(i==null)return!1;if(i===403&&t.message==="Request has expired"){if(!s.isPaused){if(s.limit===1||w(this,tt)[tt]==null){let o=e.next();if(o==null||o.done)return!1;w(this,tt)[tt]=o.value}s.rateLimit(0),await new Promise(o=>setTimeout(o,w(this,tt)[tt]))}}else if(i===429){if(!s.isPaused){let o=e.next();if(o==null||o.done)return!1;s.rateLimit(o.value)}}else{if(i>400&&i<500&&i!==409)return!1;if(typeof navigator<"u"&&navigator.onLine===!1)s.isPaused||(s.pause(),window.addEventListener("online",()=>{s.resume()},{once:!0}));else{let o=e.next();if(o==null||o.done)return!1;await new Promise(n=>setTimeout(n,o.value))}}return!0}async function ql(t,e,r){let{method:s="POST",url:i,fields:o,headers:n}=await w(this,Qt)[Qt](w(this,G)[G](t),{signal:r}).abortOn(r),a,l=e.getData();if(s.toUpperCase()==="POST"){let h=new FormData;Object.entries(o).forEach(c=>{let[f,S]=c;return h.set(f,S)}),h.set("file",l),a=h}else a=l;let{onProgress:d,onComplete:p}=e,u=await w(this,st)[st]({signature:{url:i,headers:n,method:s},body:a,size:l.size,onProgress:d,onComplete:p,signal:r}).abortOn(r);return"location"in u?u:{location:Il(i),...u}}var on;function T(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var zl=0;function pe(t){return"__private_"+zl+++"_"+t}var Hl={version:"3.11.0"};function ht(t){if(t!=null&&t.error){let e=new Error(t.message);throw Object.assign(e,t.error),e}return t}function nn(t){let e=t.Expiration;if(e){let r=Math.floor((new Date(e)-Date.now())/1e3);if(r>9)return r}}function sn(t){let{meta:e,allowedMetaFields:r,querify:s=!1}=t,i=r??Object.keys(e);return e?Object.fromEntries(i.filter(o=>e[o]!=null).map(o=>{let n=s?`metadata[${o}]`:o,a=String(e[o]);return[n,a]})):{}}var Gl={allowedMetaFields:null,limit:6,getTemporarySecurityCredentials:!1,shouldUseMultipart:t=>t.size!==0,retryDelays:[0,1e3,3e3,5e3],companionHeaders:{}},ot=pe("companionCommunicationQueue"),M=pe("client"),K=pe("cachedTemporaryCredentials"),zs=pe("getTemporarySecurityCredentials"),Hs=pe("setS3MultipartState"),nt=pe("getFile"),Gs=pe("uploadLocalFile"),Ks=pe("getCompanionClientArgs"),Zt=pe("upload"),it=pe("setCompanionHeaders"),Ae=pe("setResumableUploadsCapability"),er=pe("resetResumableCapability");on=Symbol.for("uppy test: getClient");var at=class t extends ze{constructor(e,r){var s;super(e,{...Gl,uploadPartBytes:t.uploadPartBytes,createMultipartUpload:null,listParts:null,abortMultipartUpload:null,completeMultipartUpload:null,signPart:null,getUploadParameters:null,...r}),Object.defineProperty(this,Ks,{value:Xl}),Object.defineProperty(this,Gs,{value:Wl}),Object.defineProperty(this,zs,{value:Kl}),Object.defineProperty(this,ot,{writable:!0,value:void 0}),Object.defineProperty(this,M,{writable:!0,value:void 0}),Object.defineProperty(this,K,{writable:!0,value:void 0}),Object.defineProperty(this,Hs,{writable:!0,value:(o,n)=>{let{key:a,uploadId:l}=n,d=this.uppy.getFile(o.id);d!=null&&this.uppy.setFileState(o.id,{s3Multipart:{...d.s3Multipart,key:a,uploadId:l}})}}),Object.defineProperty(this,nt,{writable:!0,value:o=>this.uppy.getFile(o.id)||o}),Object.defineProperty(this,Zt,{writable:!0,value:async o=>{if(o.length===0)return;let n=this.uppy.getFilesByIds(o),a=Qo(n),l=Zo(a);this.uppy.emit("upload-start",l);let d=a.map(u=>{if(u.isRemote){let h=()=>this.requests;T(this,Ae)[Ae](!1);let c=new AbortController,f=_=>{_.id===u.id&&c.abort()};this.uppy.on("file-removed",f);let S=this.uppy.getRequestClientForFile(u).uploadRemoteFile(u,T(this,Ks)[Ks](u),{signal:c.signal,getQueue:h});return this.requests.wrapSyncFunction(()=>{this.uppy.off("file-removed",f)},{priority:-1})(),S}return T(this,Gs)[Gs](u)}),p=await Promise.all(d);return T(this,Ae)[Ae](!0),p}}),Object.defineProperty(this,it,{writable:!0,value:()=>{T(this,M)[M].setCompanionHeaders(this.opts.companionHeaders)}}),Object.defineProperty(this,Ae,{writable:!0,value:o=>{let{capabilities:n}=this.uppy.getState();this.uppy.setState({capabilities:{...n,resumableUploads:o}})}}),Object.defineProperty(this,er,{writable:!0,value:()=>{T(this,Ae)[Ae](!0)}}),this.type="uploader",this.id=this.opts.id||"AwsS3Multipart",this.title="AWS S3 Multipart",T(this,M)[M]=new Te(e,r);let i={createMultipartUpload:this.createMultipartUpload,listParts:this.listParts,abortMultipartUpload:this.abortMultipartUpload,completeMultipartUpload:this.completeMultipartUpload,signPart:r!=null&&r.getTemporarySecurityCredentials?this.createSignedURL:this.signPart,getUploadParameters:r!=null&&r.getTemporarySecurityCredentials?this.createSignedURL:this.getUploadParameters};for(let o of Object.keys(i))this.opts[o]==null&&(this.opts[o]=i[o].bind(this));r?.prepareUploadParts!=null&&r.signPart==null&&(this.opts.signPart=async(o,n)=>{let{uploadId:a,key:l,partNumber:d,body:p,signal:u}=n,{presignedUrls:h,headers:c}=await r.prepareUploadParts(o,{uploadId:a,key:l,parts:[{number:d,chunk:p}],signal:u});return{url:h?.[d],headers:c?.[d]}}),this.requests=(s=this.opts.rateLimitedQueue)!=null?s:new Ar(this.opts.limit),T(this,ot)[ot]=new Rr(this.requests,this.opts,T(this,Hs)[Hs],T(this,nt)[nt]),this.uploaders=Object.create(null),this.uploaderEvents=Object.create(null),this.uploaderSockets=Object.create(null)}[on](){return T(this,M)[M]}setOptions(e){T(this,ot)[ot].setOptions(e),super.setOptions(e),T(this,it)[it]()}resetUploaderReferences(e,r){this.uploaders[e]&&(this.uploaders[e].abort({really:r?.abort||!1}),this.uploaders[e]=null),this.uploaderEvents[e]&&(this.uploaderEvents[e].remove(),this.uploaderEvents[e]=null),this.uploaderSockets[e]&&(this.uploaderSockets[e].close(),this.uploaderSockets[e]=null)}assertHost(e){if(!this.opts.companionUrl)throw new Error(`Expected a \`companionUrl\` option containing a Companion address, or if you are not using Companion, a custom \`${e}\` implementation.`)}createMultipartUpload(e,r){this.assertHost("createMultipartUpload"),D(r);let s=sn({meta:e.meta,allowedMetaFields:this.opts.allowedMetaFields});return T(this,M)[M].post("s3/multipart",{filename:e.name,type:e.type,metadata:s},{signal:r}).then(ht)}listParts(e,r,s){var i;let{key:o,uploadId:n,signal:a}=r;(i=a)!=null||(a=s),this.assertHost("listParts"),D(a);let l=encodeURIComponent(o);return T(this,M)[M].get(`s3/multipart/${n}?key=${l}`,{signal:a}).then(ht)}completeMultipartUpload(e,r,s){var i;let{key:o,uploadId:n,parts:a,signal:l}=r;(i=l)!=null||(l=s),this.assertHost("completeMultipartUpload"),D(l);let d=encodeURIComponent(o),p=encodeURIComponent(n);return T(this,M)[M].post(`s3/multipart/${p}/complete?key=${d}`,{parts:a},{signal:l}).then(ht)}async createSignedURL(e,r){let s=await T(this,zs)[zs](r),i=nn(s.credentials)||604800,{uploadId:o,key:n,partNumber:a}=r;return{method:"PUT",expires:i,fields:{},url:`${await Ds({accountKey:s.credentials.AccessKeyId,accountSecret:s.credentials.SecretAccessKey,sessionToken:s.credentials.SessionToken,expires:i,bucketName:s.bucket,Region:s.region,Key:n??`${crypto.randomUUID()}-${e.name}`,uploadId:o,partNumber:a})}`,headers:{"Content-Type":e.type}}}signPart(e,r){let{uploadId:s,key:i,partNumber:o,signal:n}=r;if(this.assertHost("signPart"),D(n),s==null||i==null||o==null)throw new Error("Cannot sign without a key, an uploadId, and a partNumber");let a=encodeURIComponent(i);return T(this,M)[M].get(`s3/multipart/${s}/${o}?key=${a}`,{signal:n}).then(ht)}abortMultipartUpload(e,r,s){var i;let{key:o,uploadId:n,signal:a}=r;(i=a)!=null||(a=s),this.assertHost("abortMultipartUpload");let l=encodeURIComponent(o),d=encodeURIComponent(n);return T(this,M)[M].delete(`s3/multipart/${d}?key=${l}`,void 0,{signal:a}).then(ht)}getUploadParameters(e,r){let{meta:s}=e,{type:i,name:o}=s,n=sn({meta:s,allowedMetaFields:this.opts.allowedMetaFields,querify:!0}),a=new URLSearchParams({filename:o,type:i,...n});return T(this,M)[M].get(`s3/params?${a}`,r)}static async uploadPartBytes(e){let{signature:{url:r,expires:s,headers:i,method:o="PUT"},body:n,size:a=n.size,onProgress:l,onComplete:d,signal:p}=e;if(D(p),r==null)throw new Error("Cannot upload to an undefined URL");return new Promise((u,h)=>{let c=new XMLHttpRequest;c.open(o,r,!0),i&&Object.keys(i).forEach(_=>{c.setRequestHeader(_,i[_])}),c.responseType="text",typeof s=="number"&&(c.timeout=s*1e3);function f(){c.abort()}function S(){p?.removeEventListener("abort",f)}p?.addEventListener("abort",f),c.upload.addEventListener("progress",_=>{l(_)}),c.addEventListener("abort",()=>{S(),h(kr())}),c.addEventListener("timeout",()=>{S();let _=new Error("Request has expired");_.source={status:403},h(_)}),c.addEventListener("load",_=>{if(S(),c.status===403&&c.responseText.includes("<Message>Request has expired</Message>")){let x=new Error("Request has expired");x.source=c,h(x);return}if(c.status<200||c.status>=300){let x=new Error("Non 2xx");x.source=c,h(x);return}l?.({loaded:a,lengthComputable:!0});let v=c.getResponseHeader("ETag"),F=c.getResponseHeader("Location");if(o.toUpperCase()==="POST"&&F===null&&console.warn("AwsS3/Multipart: Could not read the Location header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3-multipart#S3-Bucket-Configuration for instructions."),v===null){h(new Error("AwsS3/Multipart: Could not read the ETag header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3-multipart#S3-Bucket-Configuration for instructions."));return}d?.(v),u({ETag:v,...F?{location:F}:void 0})}),c.addEventListener("error",_=>{S();let v=new Error("Unknown error");v.source=_.target,h(v)}),c.send(n)})}install(){T(this,Ae)[Ae](!0),this.uppy.addPreProcessor(T(this,it)[it]),this.uppy.addUploader(T(this,Zt)[Zt]),this.uppy.on("cancel-all",T(this,er)[er])}uninstall(){this.uppy.removePreProcessor(T(this,it)[it]),this.uppy.removeUploader(T(this,Zt)[Zt]),this.uppy.off("cancel-all",T(this,er)[er])}};async function Kl(t){return D(t?.signal),T(this,K)[K]==null&&(this.opts.getTemporarySecurityCredentials===!0?(this.assertHost("getTemporarySecurityCredentials"),T(this,K)[K]=T(this,M)[M].get("s3/sts",t).then(ht)):T(this,K)[K]=this.opts.getTemporarySecurityCredentials(t),T(this,K)[K]=await T(this,K)[K],setTimeout(()=>{T(this,K)[K]=null},(nn(T(this,K)[K].credentials)||0)*500)),T(this,K)[K]}function Wl(t){var e=this;return new Promise((r,s)=>{let i=(d,p)=>{this.uppy.emit("upload-progress",this.uppy.getFile(t.id),{uploader:this,bytesUploaded:d,bytesTotal:p})},o=d=>{this.uppy.log(d),this.uppy.emit("upload-error",t,d),this.resetUploaderReferences(t.id),s(d)},n=d=>{let p={body:{...d},status:200,uploadURL:d.location};this.resetUploaderReferences(t.id),this.uppy.emit("upload-success",T(this,nt)[nt](t),p),d.location&&this.uppy.log(`Download ${t.name} from ${d.location}`),r()},a=new tn(t.data,{companionComm:T(this,ot)[ot],log:function(){return e.uppy.log(...arguments)},getChunkSize:this.opts.getChunkSize?this.opts.getChunkSize.bind(this):null,onProgress:i,onError:o,onSuccess:n,onPartComplete:d=>{this.uppy.emit("s3-multipart:part-uploaded",T(this,nt)[nt](t),d)},file:t,shouldUseMultipart:this.opts.shouldUseMultipart,...t.s3Multipart});this.uploaders[t.id]=a;let l=new Nt(this.uppy);this.uploaderEvents[t.id]=l,l.onFileRemove(t.id,d=>{a.abort(),this.resetUploaderReferences(t.id,{abort:!0}),r(`upload ${d} was removed`)}),l.onCancelAll(t.id,d=>{d?.reason==="user"&&(a.abort(),this.resetUploaderReferences(t.id,{abort:!0})),r(`upload ${t.id} was canceled`)}),l.onFilePause(t.id,d=>{d?a.pause():a.start()}),l.onPauseAll(t.id,()=>{a.pause()}),l.onResumeAll(t.id,()=>{a.start()}),a.start()})}function Xl(t){var e;return{...(e=t.remote)==null?void 0:e.body,protocol:"s3-multipart",size:t.data.size,metadata:t.meta}}at.VERSION=Hl.version;window.Uppy=cr;window.AwsS3Multipart=at;window.DragDrop=ke;window.StatusBar=Re;function Ws({state:t,maxFiles:e,maxSize:r,directory:s,companionUrl:i,csrfToken:o,disk:n}){return{uppy:null,state:t,uploadedFiles:[],disk:n||"s3",slugifyFilename(a){let l=a.lastIndexOf("."),d=a,p="";l!==-1&&(d=a.substring(0,l),p=a.substring(l));let u={\u0430:"a",\u0431:"b",\u0432:"v",\u0433:"g",\u0434:"d",\u0435:"e",\u0451:"e",\u0436:"zh",\u0437:"z",\u0438:"i",\u0439:"y",\u043A:"k",\u043B:"l",\u043C:"m",\u043D:"n",\u043E:"o",\u043F:"p",\u0440:"r",\u0441:"s",\u0442:"t",\u0443:"u",\u0444:"f",\u0445:"h",\u0446:"ts",\u0447:"ch",\u0448:"sh",\u0449:"sch",\u044A:"",\u044B:"y",\u044C:"",\u044D:"e",\u044E:"yu",\u044F:"ya",\u0410:"A",\u0411:"B",\u0412:"V",\u0413:"G",\u0414:"D",\u0415:"E",\u0401:"E",\u0416:"Zh",\u0417:"Z",\u0418:"I",\u0419:"Y",\u041A:"K",\u041B:"L",\u041C:"M",\u041D:"N",\u041E:"O",\u041F:"P",\u0420:"R",\u0421:"S",\u0422:"T",\u0423:"U",\u0424:"F",\u0425:"H",\u0426:"Ts",\u0427:"Ch",\u0428:"Sh",\u0429:"Sch",\u042A:"",\u042B:"Y",\u042C:"",\u042D:"E",\u042E:"Yu",\u042F:"Ya"};return d.split("").map(f=>u[f]||f).join("").toLowerCase().replace(/[^\w\s-]/g,"").replace(/[\s_]+/g,"-").replace(/^-+|-+$/g,"")+p.toLowerCase()},bytesToSize(a){let l=["Bytes","KB","MB","GB","TB"];if(a===0)return"n/a";let d=parseInt(Math.floor(Math.log(a)/Math.log(1024)),10);return d===0?`${a} ${l[d]}`:`${(a/1024**d).toFixed(1)} ${l[d]}`},viewFile(a){let d=(window.Laravel?.fileStorage||{})[this.disk]?.url||"";if(d){let p=`${d}/${a.name}`;window.open(p,"_blank")}else this.createSignedUrl(a).then(p=>{p&&window.open(p,"_blank")}).catch(p=>{console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u0438 \u043F\u043E\u0434\u043F\u0438\u0441\u0430\u043D\u043D\u043E\u0433\u043E URL:",p),alert("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u043E\u0442\u043A\u0440\u044B\u0442\u044C \u0444\u0430\u0439\u043B \u0434\u043B\u044F \u043F\u0440\u043E\u0441\u043C\u043E\u0442\u0440\u0430")})},async createSignedUrl(a){try{let l=await fetch(`/api/s3-signed-url?key=${encodeURIComponent(a.name)}&disk=${this.disk}`,{method:"GET",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":o,"X-S3-Disk":this.disk}});return l.ok?(await l.json()).url:null}catch(l){return console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u0438 \u043F\u043E\u0434\u043F\u0438\u0441\u0430\u043D\u043D\u043E\u0433\u043E URL:",l),null}},async deleteFile(a){if(confirm("\u0412\u044B \u0443\u0432\u0435\u0440\u0435\u043D\u044B, \u0447\u0442\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u044D\u0442\u043E\u0442 \u0444\u0430\u0439\u043B?"))try{return(await fetch("/api/s3-delete-file",{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":o,"X-S3-Disk":this.disk},body:JSON.stringify({key:a.name})})).ok?(this.uploadedFiles=this.uploadedFiles.filter(d=>d.name!==a.name),this.uploadedFiles.length===0&&(this.state=""),!0):(alert("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u0444\u0430\u0439\u043B. \u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u043F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0441\u043D\u043E\u0432\u0430 \u043F\u043E\u0437\u0436\u0435."),!1)}catch(l){return console.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0438 \u0444\u0430\u0439\u043B\u0430:",l),alert("\u041F\u0440\u043E\u0438\u0437\u043E\u0448\u043B\u0430 \u043E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0438 \u0444\u0430\u0439\u043B\u0430."),!1}},init:function(){this.state&&(this.uploadedFiles=[{name:this.state,type:null,size:null}]),this.uppy=new cr({id:"uppy",debug:!0,restrictions:{maxNumberOfFiles:e,maxFileSize:r,minNumberOfFiles:1},onBeforeFileAdded:a=>{let l=this.slugifyFilename(a.name);return console.log(`\u041D\u043E\u0440\u043C\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F \u0438\u043C\u0435\u043D\u0438 \u0444\u0430\u0439\u043B\u0430: ${a.name} -> ${l}`),{...a,name:l}},onBeforeUpload:a=>{let l={};return Object.keys(a).forEach(d=>{l[d]={...a[d],name:`${s}/${a[d].name}`}}),l}}),this.uppy.use(ke,{target:".uppy__input"}).use(Re,{target:".uppy__progress-bar"}).use(at,{limit:6,companionUrl:i,companionHeaders:{"X-CSRF-TOKEN":o,"X-S3-Disk":this.disk}}),this.uppy.on("file-added",a=>{Ws.upload&&Ws.upload()}),this.uppy.on("upload-success",(a,l)=>{this.state=l.body.path,e===1?this.uploadedFiles=[a]:this.uploadedFiles=[...this.uploadedFiles,a]})}}}export{Ws as default};
/*! Bundled license information:

classnames/index.js:
  (*!
  	Copyright (c) 2018 Jed Watson.
  	Licensed under the MIT License (MIT), see
  	http://jedwatson.github.io/classnames
  *)

@uppy/utils/lib/Translator.js:
  (**
   * Takes a string with placeholder variables like `%{smart_count} file selected`
   * and replaces it with values from options `{smart_count: 5}`
   *
   * @license https://github.com/airbnb/polyglot.js/blob/master/LICENSE
   * taken from https://github.com/airbnb/polyglot.js/blob/master/lib/polyglot.js#L299
   *
   * @param phrase that needs interpolation, with placeholders
   * @param options with values that will be used to replace placeholders
   *)
*/
